package org.ipring.jacg.process;

import java.util.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * SQL表名提取工具类
 * 支持解析SELECT/UPDATE/DELETE/INSERT等常见SQL的表名
 */
public class SqlTableExtractor {

    // 正则表达式：匹配FROM/JOIN/UPDATE/DELETE FROM/INSERT INTO后的表名（处理别名）
    private static final Pattern TABLE_PATTERN = Pattern.compile(
        // 匹配FROM/JOIN/UPDATE/DELETE FROM/INSERT INTO 后的表名
        "(?i)(?:from|join|update|delete from|insert into)\\s+([a-zA-Z0-9_]+)\\s*(?:\\w+)?",
        Pattern.CASE_INSENSITIVE
    );

    /**
     * 提取单条SQL中的所有表名（去重）
     * @param sql 待解析的SQL语句
     * @return 表名列表（去重）
     */
    public static List<String> extractTableNames(String sql) {
        if (sql == null || sql.trim().isEmpty()) {
            return Collections.emptyList();
        }

        // 步骤1：清理SQL - 去除换行、多余空格，统一格式
        String cleanedSql = sql.replaceAll("\\s+", " ")  // 替换多个空格/换行为单个空格
                               .replaceAll("/\\*.*?\\*/", "")  // 去除多行注释
                               .replaceAll("--.*", "")  // 去除单行注释
                               .trim();

        // 步骤2：正则匹配表名
        Matcher matcher = TABLE_PATTERN.matcher(cleanedSql);
        Set<String> tableNames = new LinkedHashSet<>();  // 有序且去重

        while (matcher.find()) {
            String tableName = matcher.group(1);
            if (tableName != null && !tableName.trim().isEmpty()) {
                tableNames.add(tableName.trim());
            }
        }

        // 步骤3：返回去重后的表名列表
        return new ArrayList<>(tableNames);
    }

    /**
     * 批量提取多条SQL中的所有表名（去重）
     * @param sqlList 多条SQL语句的列表
     * @return 所有SQL中的表名（全局去重）
     */
    public static List<String> extractTableNamesFromBatch(List<String> sqlList) {
        Set<String> allTables = new LinkedHashSet<>();
        for (String sql : sqlList) {
            allTables.addAll(extractTableNames(sql));
        }
        return new ArrayList<>(allTables);
    }

    // 测试示例
    public static void main(String[] args) {
        // 你的示例SQL列表
        List<String> sqlList = new ArrayList<>();
        sqlList.add("INSERT INTO route_plan_courier_address ( driver_id, driver_name, dept_id, address_type, address, country, provinces, cities, counties, post_code, longitude, latitude, update_time) VALUES ( #{driverId}, #{driverName}, #{deptId}, #{addressType} , #{address}, #{country}, #{provinces}, #{cities}, #{counties} , #{postCode}, #{longitude}, #{latitude}, #{updateTime})");
        sqlList.add("INSERT INTO route_plan_task_consume ( task_id, plan_code, msg_json, task_type) VALUES (#{consume.taskId},#{consume.planCode},#{consume.msgJson},#{consume.taskType})");
        sqlList.add("INSERT INTO task_pickup_detail ( task_pickup_id, pickup_plan_id, bef_seq_num, seq_num, warehouse_type, secondary_address, quay, quay_name, address_detail, city, state, postcode, package_count, og_package_count, longitude, latitude, unique_group, area, goods_size_type, oper_source, shipper_phone, shipper_name, business_hours, pick_time_start, pick_time_end, remark, create_by, create_by_name, update_by, update_by_name ) VALUES ( #{item.taskPickupId}, #{item.pickupPlanId}, #{item.befSeqNum}, #{item.seqNum}, #{item.warehouseType}, #{item.secondaryAddress}, #{item.quay}, #{item.quayName}, #{item.addressDetail}, #{item.city}, #{item.state}, #{item.postcode}, #{item.packageCount}, #{item.ogPackageCount}, #{item.longitude}, #{item.latitude}, #{item.uniqueGroup}, #{item.area}, #{item.goodsSizeType}, #{item.operSource}, #{item.shipperPhone}, #{item.shipperName}, #{item.businessHours}, #{item.pickTimeStart}, #{item.pickTimeEnd}, #{item.remark}, #{item.createBy}, #{item.createByName}, #{item.updateBy}, #{item.updateByName} )");
        sqlList.add("INSERT INTO task_pickup_detail_plan_ref ( pickup_detail_id, pickup_plan_id, create_by, create_by_name, update_by, update_by_name ) VALUES ( #{item.pickupDetailId}, #{item.pickupPlanId}, #{item.createBy}, #{item.createByName}, #{item.updateBy}, #{item.updateByName} )");
        sqlList.add("SELECT * FROM hub_assign_task_return WHERE del_flag = 0 AND task_code IN ( #{item} ) AND create_dept_id IN ( #{item} ) AND task_status = #{dto.taskStatus} AND driver_id = #{dto.driverId} AND create_time BETWEEN #{dto.startTimeStr} AND #{dto.endTimeStr} ORDER BY id DESC");
        sqlList.add("SELECT * FROM task_pickup WHERE del_flag = 0 AND code IN ( #{item} ) AND parent_code IN ( #{item} ) AND source_code IN ( #{item} ) AND route_plan_code IN ( #{item} ) AND group_id IN ( #{item} ) AND driver_id IN ( #{item} ) AND car_type_id = #{dto.carTypeId} AND status IN ( #{item} ) AND execute_status IN ( #{item} ) AND plan_depart_time BETWEEN #{dto.planDepartTimeStart} AND #{dto.planDepartTimeEnd} AND create_time BETWEEN #{dto.createTimeStart} AND #{dto.createTimeEnd} AND source_code IS NOT NULL AND source_code != '' AND (source_code IS NULL OR source_code = '') ORDER BY id DESC");
        sqlList.add("SELECT * FROM task_pickup WHERE del_flag = 0 AND driver_id IN ( #{item} ) AND status IN ( #{item} ) AND execute_status IN ( #{item} ) ORDER BY plan_depart_time ASC, id ASC");
        sqlList.add("SELECT MAX(IFNULL(version, 0)) from task_pool_rule_log WHERE rule_id = #{ruleId}");
        sqlList.add("SELECT MAX(seq_num) as seq_num, MAX(bef_seq_num) AS bef_seq_num FROM task_pickup_detail WHERE del_flag = 0 AND task_pickup_id = #{taskPickupId}");
        sqlList.add("SELECT MAX(task_pickup_detail.seq_num) as seq_num, MAX(task_pickup_detail.bef_seq_num) AS bef_seq_num FROM task_pickup JOIN task_pickup_detail ON task_pickup.id = task_pickup_detail.task_pickup_id WHERE task_pickup.del_flag = 0 and task_pickup_detail.del_flag = 0 AND task_pickup.source_code = #{sourceCode}");
        sqlList.add("SELECT a.id, a.driver_id as driverId, a.driver_name as driverName, a.address_type as addressType, CASE WHEN a.address_type = 1 THEN 'Courier address' END as addressTypeStr, a.address, a.country, a.provinces, a.cities, a.counties, a.post_code as postCode, a.longitude, a.latitude, a.del_flag as delFlag, a.driver_uses as driverUses, a.create_time as createTime, a.update_time as updateTime FROM route_plan_courier_address a where a.driver_id = #{ew.driverId} and a.driver_name = #{ew.driverName} and a.del_flag = #{ew.delFlag} and a.post_code = #{ew.postCode} and a.provinces = #{ew.provinces} and a.cities = #{ew.cities} and a.counties = #{ew.counties} and case when update_time is not null then a.update_time BETWEEN #{ew.startTime} and #{ew.endTime} else a.create_time BETWEEN #{ew.startTime} and #{ew.endTime} end and a.dept_id in ( #{deptId} ) order by create_time desc");
        sqlList.add("SELECT hwp.data_source AS dataSource, count(distinct hwp.waybill_no) AS waybillCount from hub_waybill_pool hwp left join mis_waybill_info mwi on hwp.waybill_no = mwi.waybill_no LEFT JOIN work_areas_courier t ON t.station_id = CASE WHEN mwi.dept_id REGEXP '^[0-9]+$' and mwi.dept_id != '' THEN CAST(mwi.dept_id AS UNSIGNED) ELSE NULL END AND t.name = mwi.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = t.id where hwp.waybill_no = mwi.waybill_no and mwi.express_status!='205' and hwp.waybill_no in ( #{waybill} ) and hwp.box_no in ( #{boxNo} ) and mwi.dept_id in ( #{deliveryId} ) and hwp.plan_status in ( #{status} ) and hwp.exception_type in ( #{item} ) and mwi.express_status in ( #{item} ) and t.id in ( #{item} ) and d.courier_id in ( #{item} ) and hwp.data_source in ( #{item} ) and hwp.create_dept_id in ( #{item} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.plan_arrival_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.plan_sorting_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.transfer_center_id in ( #{filterCenterId} ) and hwp.transfer_center_id in ( #{centerId} ) and exists( select 1 from work_areas_postcode rddp where rddp.area_id in( concat('E_', #{item}) ) and rddp.postcode=hwp.to_code and rddp.`type` = 'COURIER' ) and hwp.to_code in ( #{item} ) group by hwp.data_source");
        sqlList.add("SELECT hwp.data_source AS dataSource, count(distinct hwp.waybill_no) AS waybillCount from hub_waybill_pool hwp left join work_areas_courier t on t.station_id = hwp.dept_id and t.name = hwp.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = t.id where hwp.express_status != '205' and hwp.waybill_no in ( #{waybill} ) and hwp.box_no in ( #{boxNo} ) and hwp.dept_id in ( #{deliveryId} ) and hwp.plan_status in ( #{status} ) and hwp.exception_type in ( #{item} ) and hwp.express_status in ( #{item} ) and t.id in ( #{item} ) and d.courier_id in ( #{item} ) and hwp.data_source in ( #{item} ) and hwp.create_dept_id in ( #{item} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.plan_arrival_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.plan_sorting_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.transfer_center_id in ( #{filterCenterId} ) and hwp.transfer_center_id in ( #{centerId} ) and exists( select 1 from work_areas_postcode rddp where rddp.area_id in( concat('E_', #{item}) ) and rddp.postcode=hwp.to_code and rddp.`type` = 'COURIER' ) and hwp.to_code in ( #{item} ) and hwp.address_type in ( #{item} ) group by hwp.data_source");
        sqlList.add("SELECT id AS id, task_id AS taskId, plan_code AS planCode, msg_json AS msgJson, task_type AS taskType, create_time AS createTime, del_flag AS delFlag FROM route_plan_task_consume WHERE del_flag = 0");
        sqlList.add("SELECT id, rule_name, group_id, group_name, del_flag, create_time, time_zone, create_time_ts, create_by, create_by_name, update_time, update_time_ts, update_by, update_by_name FROM pickup_task_rule WHERE del_flag = 0 AND group_id = #{taskRuleDTO.groupId} AND rule_name LIKE CONCAT('%',#{taskRuleDTO.ruleName},'%') ORDER BY id DESC");
        sqlList.add("SELECT mw.id, mw.waybill_no as waybillNo, mw.express_status as expressStatus, mw.to_name as toName, mw.to_phone as toPhone, mw.to_email as toEmail, mw.to_code as toCode, mw.to_country as toCountry, mw.to_state as toState, mw.to_city as toCity, mw.to_area as toArea, mw.to_street as toStreet, mw.to_num_int as toNumInt, mw.to_num_ext as toNumExt, mw.service_type as serviceType, mw.longitude as longitude, mw.latitude as latitude, mw.dept_id as deptId FROM mis_waybill_info mw where mw.del_flag = 0 and mw.waybill_no in ( #{waybillNo} )");
        sqlList.add("SELECT mw.waybill_no as waybillNo, mw.package_no as packageNo, mw.to_code as toCode, mw.to_expand_code as toExpandCode, mw.dept_id as deptId, mw.target_center_id as transferCenterId, mw.target_center_name as transferCenter, mw.delivery as delivery, mw.express_status as expressStatus, mw.courier_work_area as courierWorkArea, mw.to_street as toStreet, mw.to_city as toCity, mw.longitude as longitude, mw.latitude as latitude FROM mis_waybill_info mw WHERE mw.waybill_no in ( #{item} ) and mw.del_flag = 0");
        sqlList.add("SELECT mwi.id, mwi.waybill_no AS waybillNo, mwi.dept_id AS deptId, mwi.settlement_weight AS settlementWeight, mwi.to_code AS toCode, mwi.to_expand_code toExpandCode, mwi.express_status AS expressStatus, mwi.driver_id AS driverId, mwi.weight AS weight, mwi.length AS length, mwi.width AS width, mwi.height AS height, mwi.total_amount AS totalAmount, mwi.service_type as serviceType , mwi.package_no as packageNo, mwi.delivery as delivery, mwe.freight_forward_id as freightForwardId, mwe.freight_forwarder as freightForwarder, mwe.pudo_id as pudoId FROM mis_waybill_info mwi left join mis_waybill_expand mwe on mwi.waybill_no = mwe.waybill_no WHERE mwi.waybill_no IN ( #{item} )");
        sqlList.add("SELECT pkd.id, pkd.package_no, pkd.dept_id as original_id, pkd.dept_name as original_name, pkd.destin_id, pkd.destin_name, pkd.destin_type, pkd.create_time, pkd.create_by, pkd.create_by_name, pkd.departed, pkd.create_by_name as user_name, pkd.exchange_bureau_code, pkd.check_in_time, pkd.check_out_time, pkd.start_center_id, pkd.destin_center_id, pkd.site_status, pkd.check_out_time, pkd.package_type FROM mis_package_dept_ref pkd LEFT JOIN mis_servicer_info si ON (si.id = pkd.destin_id) where pkd.id in ( #{item} ) and pkd.package_no like concat( #{packageNo}, '%') and pkd.dept_id = #{deptId} and pkd.departed = #{departed} and (pkd.destin_name LIKE concat(#{destinName}, '%') or si.name like concat(#{destinName}, '%')) AND pkd.destin_id = #{destinId} AND pkd.create_time between concat(#{beginTime},' 00:00:00') and concat(#{endTime},' 23:59:59') AND pkd.check_in_time between concat(#{checkInBeginTime},' 00:00:00') and concat(#{checkInEndTime},' 23:59:59') AND pkd.check_out_time between concat(#{checkOutBeginTime},' 00:00:00') and concat(#{checkOutEndTime},' 23:59:59') and pkd.departed in ( #{item} ) and pkd.package_no in ( #{item} ) AND pkd.create_by=#{createBy} and pkd.create_by_name='sorter' and not exists ( select 1 from mis_box_scan_record where box_num=pkd.package_no ) AND pkd.create_by=#{createBy} and not exists ( select 1 from mis_box_scan_record where box_num=pkd.package_no ) AND pkd.departed in(0,1,2,5) AND pkd.start_center_id = #{startCenterId} AND pkd.destin_center_id = #{destinCenterId} AND pkd.destin_area_code = #{destinAreaCode} ${params.dataScope} order by pkd.create_time desc");
        sqlList.add("SELECT t1.id as id, CONCAT(t1.station_id, '-', t2.postcode, '-', t2.pudo_id, '-2') AS uniqueCode, t1.station_id as stationId, t2.postcode as postcode, t2.pudo_id as pudoId, t1.business_model as businessModel FROM work_areas_courier t1 INNER JOIN work_areas_pudo_coverage t2 ON t2.work_area_id = t1.id WHERE t1.status = 0");
        sqlList.add("SELECT task_pickup_id as taskPickupId, SUM(package_count) AS packageCount FROM task_pickup_detail WHERE del_flag = 0 AND task_pickup_id IN ( #{taskPickupId} ) GROUP BY task_pickup_id");
        sqlList.add("SELECT wac.id, wac.name, wap.postcode FROM work_areas_courier wac LEFT JOIN work_areas_postcode wap ON wap.area_id = concat(, wac.id) WHERE wap.postcode in ( #{postcode} )");
        sqlList.add("UPDATE hub_assign_task SET waybill_count = CASE id WHEN #{item.id} THEN waybill_count - #{item.waybillCount} END WHERE id IN ( #{item.id} )");
        sqlList.add("UPDATE hub_assign_task_return_detail SET seq_num = CASE id WHEN #{item.id} THEN #{item.seqNum} END WHERE del_flag = 0 AND id IN ( #{item.id} )");
        sqlList.add("UPDATE hub_assign_task_stop SET waybill_sort = CASE id WHEN #{item.id} THEN #{item.waybillSort} END, full_stop = CASE id WHEN #{item.id} THEN #{item.fullStop} END WHERE id IN ( #{item.id} )");
        sqlList.add("UPDATE route_plan_courier_address SET driver_uses = driver_uses+1 WHERE driver_id = #{id};");
        sqlList.add("UPDATE route_plan_task_consume SET del_flag = 1 WHERE task_id = #{taskId}");
        sqlList.add("UPDATE route_plan_task_consume SET task_type = #{type} WHERE task_id = #{taskId}");
        sqlList.add("UPDATE task_pickup_detail SET remark = RIGHT(CONCAT(task_pickup_detail.remark, '|', #{dto.remark}), 1024), update_by = #{dto.userId}, update_by_name = #{dto.userName} WHERE del_flag = 0 AND id IN ( #{id} )");
        sqlList.add("UPDATE task_pickup_detail SET seq_num = CASE id WHEN #{item.id} THEN #{item.seqNum} END WHERE del_flag = 0 AND id IN ( #{item.id} )");
        sqlList.add("UPDATE task_pickup_detail SET task_pickup_id = CASE id WHEN #{item.id} THEN #{item.taskPickupId} END, bef_seq_num = seq_num WHERE del_flag = 0 AND id IN ( #{item.id} )");
        sqlList.add("UPDATE task_pickup_detail SET task_pickup_id = CASE id WHEN #{item.id} THEN #{item.taskPickupId} END, seq_num = CASE id WHEN #{item.id} THEN #{item.seqNum} END, bef_seq_num = CASE id WHEN #{item.id} THEN #{item.befSeqNum} END, oper_source = CASE id WHEN #{item.id} THEN #{item.operSource} END WHERE del_flag = 0 AND id IN ( #{item.id} )");
        sqlList.add("delete from hub_assign_task_setup where create_by = #{createBy} and id = #{id}");
        sqlList.add("delete from hub_assign_task_stop where task_id = #{taskId}");
        sqlList.add("delete from hub_assign_task_stop where task_id = #{taskId} and sindex = #{stopIndex}");
        sqlList.add("delete from hub_assign_task_stop where waybill_no in ( #{item} ) and task_id in ( #{item} )");
        sqlList.add("delete from hub_assign_task_waybill where task_id in ( #{item} ) and waybill_no in ( #{item} )");
        sqlList.add("delete from hub_assign_task_waybill where task_id in ( #{taskIdItem} )");
        sqlList.add("delete from hub_box_pool t1 where not exists ( select 1 from hub_waybill_pool t2 where t2.box_no=t1.box_no ) and t1.box_no in( #{boxNo} )");
        sqlList.add("delete from hub_box_pool where box_no = #{boxNo}");
        sqlList.add("delete from hub_box_pool where box_no in ( #{boxNo} )");
        sqlList.add("delete from hub_box_pool where box_no in ( #{boxNo} )");
        sqlList.add("delete from hub_task_map_region_polygon where type = 1 and delivery_id = #{dto.deliveryId}");
        sqlList.add("delete from hub_task_map_region_polygon where type = 2 and delivery_id = #{dto.deliveryId} and area_id = #{dto.areaId} and area_id = ''");
        sqlList.add("delete from hub_waybill_pool where box_no in ( #{boxNo} )");
        sqlList.add("delete from hub_waybill_pool where waybill_no in ( #{waybillNo} )");
        sqlList.add("delete from hub_waybill_pool where waybill_no in ( #{waybillNo} )");
        sqlList.add("delete from hub_waybill_pool where waybill_no in ( #{waybillNo} )");
        sqlList.add("delete from hub_waybill_pool_record where id = #{id}");
        sqlList.add("delete from route_plan_address where id = #{id}");
        sqlList.add("delete from route_plan_async_log where id=#{id}");
        sqlList.add("delete from waybill_sort where user_Id=#{userId} and waybill_no in ( #{item} )");
        sqlList.add("insert into hub_assign_task ( task_no, p_task_no, delivery_id, delivery, area_id, area_name, box_no, waybill_count, bag_count, to_code, task_status, plan_status, sequence_no, plan_sorting_time, driver_id, driver_name, delivery_mode, create_by, create_by_name, create_time, create_dept_id, create_dept_name, update_by, update_by_name, update_time, transfer_center_id, transfer_center, delivery_line_name, generate_style, generate_rule, sort_code, business_model) values( #{vo.taskNo}, #{vo.pTaskNo}, #{vo.deliveryId}, #{vo.delivery}, #{vo.areaId}, #{vo.areaName}, #{vo.boxNo}, #{vo.waybillCount}, #{vo.bagCount}, #{vo.toCode}, #{vo.taskStatus}, #{vo.planStatus}, #{vo.sequenceNo}, #{vo.planSortingTime}, #{vo.driverId}, #{vo.driverName}, #{vo.deliveryMode}, #{vo.createBy}, #{vo.createByName}, #{vo.createTime}, #{vo.createDeptId}, #{vo.createDeptName}, #{vo.createBy}, #{vo.createByName}, #{vo.createTime}, #{vo.transferCenterId}, #{vo.transferCenter}, #{vo.deliveryLineName}, #{vo.generateStyle}, #{vo.generateRule}, #{vo.sortCode}, #{vo.businessModel} )");
        sqlList.add("insert into hub_assign_task ( task_no, p_task_no, o_task_no, delivery_id, delivery, area_id, area_name, box_no, waybill_count, bag_count, to_code, task_status, plan_status, plan_code, sequence_no, plan_sorting_time, delivery_day, driver_id, driver_name, delivery_mode, recipient_id, recipient_name, recipient_dept_id, recipient_dept_name, recipient_date, create_by, create_by_name, create_time, create_dept_id, create_dept_name, update_by, update_by_name, update_time, transfer_center_id, transfer_center, push_user_id, push_user_name, push_time, delivery_line_name, generate_style, generate_rule, sort_code, task_split_mode, business_model) values( #{vo.taskNo}, #{vo.pTaskNo}, #{vo.oTaskNo}, #{vo.deliveryId}, #{vo.delivery}, #{vo.areaId}, #{vo.areaName}, #{vo.boxNo}, #{vo.waybillCount}, #{vo.bagCount}, #{vo.toCode}, #{vo.taskStatus}, #{vo.planStatus}, #{vo.planCode}, #{vo.sequenceNo}, #{vo.planSortingTime}, #{vo.deliveryDay}, #{vo.driverId}, #{vo.driverName}, #{vo.deliveryMode}, #{vo.recipientId}, #{vo.recipientName}, #{vo.recipientDeptId}, #{vo.recipientDeptName}, #{vo.recipientDate}, #{vo.createBy}, #{vo.createByName}, #{vo.createTime}, #{vo.createDeptId}, #{vo.createDeptName}, #{vo.createBy}, #{vo.createByName}, #{vo.createTime}, #{vo.transferCenterId}, #{vo.transferCenter}, #{vo.pushUserId}, #{vo.pushUserName}, #{vo.pushTime}, #{vo.deliveryLineName}, #{vo.generateStyle}, #{vo.generateRule}, #{vo.sortCode}, #{vo.taskSplitMode}, #{vo.businessModel} )");
        sqlList.add("insert into hub_assign_task_log ( task_id, task_no, operation_type, content, create_time, create_by, create_by_name, update_time, update_by, update_by_name ) values ( #{taskId}, #{taskNo}, #{operationType}, #{content}, #{createTime}, #{createBy}, #{createByName}, #{updateTime}, #{updateBy}, #{updateByName} )");
        sqlList.add("insert into hub_assign_task_setup ( max_waybill_count,min_waybill_count ,color,create_by ,create_by_name,create_time,create_dept_id ,create_dept_name) values (#{maxWaybillCount},#{minWaybillCount} ,#{color},#{createBy} ,#{createByName},#{createTime},#{createDeptId} ,#{createDeptName})");
        sqlList.add("insert into hub_assign_task_stop ( task_id, task_no, stop_index, lot_number, sindex , recipient_stop, waybill_sort, full_stop, latitude, longitude, format_address, finance_format_address, delivery_format_address, stop_model, waybill_no ) values ( #{vo.taskId}, #{vo.taskNo}, #{vo.stopIndex}, #{vo.lotNumber}, #{vo.sindex}, #{vo.recipient}, #{vo.waybillSort}, #{vo.fullStop}, #{vo.latitude}, #{vo.longitude}, #{vo.formatAddress}, #{vo.financeFormatAddress}, #{vo.deliveryFormatAddress}, #{vo.stopModel}, #{vo.waybillNo} )");
        sqlList.add("insert into hub_assign_task_waybill ( task_id, waybill_no, box_no, data_id, bag_flag, to_code, plan_arrival_time, plan_sorting_time, delivery_id ) values ( #{vo.taskId}, #{vo.waybillNo}, #{vo.boxNo}, #{vo.dataId}, #{vo.bagFlag}, #{vo.toCode}, #{vo.planArrivalTime}, #{vo.planSortingTime}, #{vo.deliveryId} )");
        sqlList.add("insert into hub_box_pool ( box_no, line_name, allocation_status, create_time, create_by, create_by_name, create_dept_id, create_dept_name, transfer_center_id, transfer_center) values ( #{vo.boxNo}, #{vo.lineName}, 1, #{vo.createTime}, #{vo.createBy}, #{vo.createByName}, #{vo.createDeptId}, #{vo.createDeptName}, #{vo.transferCenterId}, #{vo.transferCenter} )");
        sqlList.add("insert into hub_box_pool ( box_no, line_name, allocation_status, create_time, create_by, create_by_name, create_dept_id, create_dept_name, transfer_center_id, transfer_center) values ( #{vo.boxNo}, #{vo.lineName}, 1, #{vo.createTime}, #{vo.createBy}, #{vo.createByName}, #{vo.createDeptId}, #{vo.createDeptName}, #{vo.transferCenterId}, #{vo.transferCenter} )");
        sqlList.add("insert into hub_box_pool ( box_no, line_name, allocation_status, create_time, create_by, create_by_name, create_dept_id, create_dept_name, transfer_center_id, transfer_center) values ( #{vo.boxNo}, #{vo.lineName}, 1, #{vo.createTime}, #{vo.createBy}, #{vo.createByName}, #{vo.createDeptId}, #{vo.createDeptName}, #{vo.transferCenterId}, #{vo.transferCenter} ) on duplicate key update line_name = VALUES(`line_name`)");
        sqlList.add("insert into hub_task_map_region_polygon ( type,area_id ,delivery_id,locations_json,create_by ,create_by_name,create_time,create_dept_id ,create_dept_name) values (#{param.type},#{param.areaId} ,#{param.deliveryId},#{param.locationsJson},#{param.createBy} ,#{param.createByName},#{param.createTime},#{param.createDeptId} ,#{param.createDeptName})");
        sqlList.add("insert into hub_waybill_pool ( waybill_no, box_no, to_code, add_type, create_time, create_by, create_by_name, create_dept_id, create_dept_name, arrival_time, plan_status, origin, exception_type, transfer_center_id, transfer_center_name, plan_arrival_time, plan_sorting_time, exchange_bureau_code, data_source, operate_by, operate_by_name, operate_time, dept_id, delivery, to_expand_code, express_status, courier_work_area, return_flag, address_type, address_type_view ) values ( #{vo.waybillNo}, #{vo.boxNo}, #{vo.toCode}, #{vo.addType}, #{vo.createTime}, #{vo.createBy}, #{vo.createByName}, #{vo.createDeptId}, #{vo.createDeptName}, #{vo.arrivalTime}, #{vo.planStatus}, #{vo.origin}, #{vo.exceptionType}, #{vo.transferCenterId}, #{vo.transferCenter}, #{vo.planArrivalTime}, #{vo.planSortingTime}, #{vo.exchangeBureauCode}, #{vo.dataSource}, #{vo.operateBy}, #{vo.operateByName}, #{vo.operateTime}, #{vo.deptId}, #{vo.delivery}, #{vo.toExpandCode}, #{vo.expressStatus}, #{vo.courierWorkArea}, #{vo.returnFlag}, #{vo.addressType}, #{vo.addressTypeView} )");
        sqlList.add("insert into hub_waybill_pool_into_out_log ( waybill_no, box_no, type, data_source, create_by, create_by_name, create_time, create_dept_id, create_dept_name, update_by, update_by_name, update_time )values ( #{log.waybillNo}, #{log.boxNo}, #{log.type}, #{log.dataSource}, #{log.createBy}, #{log.createByName}, #{log.createTime}, #{log.createDeptId}, #{log.createDeptName}, #{log.updateBy}, #{log.updateByName}, #{log.updateTime} )");
        sqlList.add("insert into hub_waybill_pool_record ( delete_type, box_no, waybill_no, create_by, create_by_name, create_time ) values ( #{deleteType}, #{boxNo}, #{waybillNo}, #{createBy}, #{createByName}, #{createTime} )");
        sqlList.add("insert into hub_waybill_pool_record (delete_type, box_no, waybill_no, create_by, create_by_name, create_time ) values (#{deleteType}, #{boxNo}, #{waybillNo}, #{createBy}, #{createByName}, #{createTime} )");
        sqlList.add("insert into route_location_log ( waybill_no, create_time, status, request_url, query_score )values( #{waybillNo}, #{createDate}, #{status}, #{requestUrl}, #{queryScore} )");
        sqlList.add("insert into route_plan_address ( address_type, `state`, city, area, address, post_code, longitude, latitude, usage_count, `status`, create_by, create_by_name, update_by, update_by_name, dept_id, dept_name, create_time, update_time ) values ( #{addressType}, #{state}, #{city}, #{area}, #{address}, #{postCode}, #{longitude}, #{latitude}, #{usageCount}, #{status}, #{createBy}, #{createByName}, #{updateBy}, #{updateByName}, #{deptId}, #{deptName}, #{createTime}, #{updateTime} )");
        sqlList.add("insert into route_plan_address (address_type, state_id, city_id, area_id, `state`, city, area, address, post_code, longitude, latitude, usage_count, `status`, create_by, create_by_name, update_by, update_by_name, dept_id, dept_name, create_time, update_time ) values (#{addressType},#{stateId}, #{cityId}, #{areaId}, #{state}, #{city}, #{area}, #{address}, #{postCode}, #{longitude}, #{latitude}, #{usageCount}, #{status}, #{createBy}, #{createByName}, #{updateBy}, #{updateByName}, #{deptId}, #{deptName}, #{createTime}, #{updateTime} )");
        sqlList.add("insert into route_plan_async_data ( log_id, result_json, planned_count, planned_success, planned_fail )values( #{vo.logId}, #{vo.resultJson}, #{vo.plannedCount}, #{vo.plannedSuccess}, #{vo.plannedFail} )");
        sqlList.add("insert into route_plan_async_log ( request_type, status, status_id, status_href, resource_id, resource_href, dept_id, transfer_center_id, transfer_center_name, create_by, create_by_name, create_time, del_flag, operator_role, request_method, plan_code, request_param, area_id, supplier_mode, model, update_time, parent_id )values( #{vo.requestType}, #{vo.status}, #{vo.statusId}, #{vo.statusHref}, #{vo.resourceId}, #{vo.resourceHref}, #{vo.deptId}, #{vo.transferCenterId}, #{vo.transferCenterName}, #{vo.createBy}, #{vo.createByName}, #{vo.createTime}, #{vo.delFlag}, #{vo.operatorRole}, #{vo.requestMethod}, #{vo.planCode}, #{vo.requestParam}, #{vo.areaId}, #{vo.supplierMode}, #{vo.model}, #{vo.updateTime}, #{vo.parentId} )");
        sqlList.add("insert into route_plan_line ( area_id, api_method, operating_mode, data_id, batch_no, dept_id, create_time, create_by, create_by_name )values( #{param.areaId}, #{param.apiMethod}, #{param.operatingMode}, #{param.dataId}, #{param.batchNo}, #{param.deptId}, #{param.createTime}, #{param.createBy}, #{param.createByName} )");
        sqlList.add("insert into route_plan_line_waybill ( line_id, waybill_no, sort_number, create_by )values( #{param.lineId}, #{param.waybillNo}, #{param.sortNumber}, #{param.createBy} )");
        sqlList.add("insert into route_plan_waybill ( waybill_no, waybill_sort, driver_id, data_id, data_type, distance, cost_time, longitude, latitude, reasons_code) values ( #{item.waybillNo}, #{item.waybillSort}, #{item.driverId}, #{item.dataId}, #{item.dataType}, #{item.distance}, #{item.costTime}, #{item.longitude}, #{item.latitude}, #{item.reasonsCode} )");
        sqlList.add("insert into waybill_sort (waybill_no,sort_number,user_Id,create_time,source_method,data_id) values (#{item.waybillNo},#{item.sortNumber},#{item.userId},#{item.createTime},#{item.sourceMethod},#{item.dataId})");
        sqlList.add("select * from task_route_plan_duration_split where task_id = #{taskId} and plan_code = #{planCode} and del_flag = 2 and waybill_no is not null");
        sqlList.add("select a.id as areaId, p.postcode as postCode, a.business_model as businessModel from work_areas_postcode p left join work_areas_courier a on p.area_id=concat(, a.id) where p.type = 'COURIER' and p.postcode in ( #{postCode} ) and a.status = 0");
        sqlList.add("select a.id as areaId, p.postcode as postCode, a.business_model as businessModel, p.freight_forwarder_id as freightForwarderId from work_areas_freight_forwarder p left join work_areas_courier a on p.work_areas_courier_id = a.id where p.freight_forwarder_id in ( #{freightForwarderId} ) and a.status = 0");
        sqlList.add("select a.id as areaId, p.postcode as postCode, a.business_model as businessModel, p.pudo_id as pudoId from work_areas_pudo_coverage p left join work_areas_courier a on p.work_area_id = a.id where p.postcode in ( #{postCode} ) and a.status = 0");
        sqlList.add("select a.id as id , a.operation_code as operationCode, r.group_id as groupId,a.operate_organize_type as operateOrganizeType ,a.group_id as specifyGroup, a.group_name as specifyGroupName from task_pool_rule_allow_into a left join task_pool_rule_group_ref r on a.rule_id = r.rule_id left join task_pool_rule ru on ru.id = a.rule_id where ru.status = 1 and r.group_id in ( #{groupId} )");
        sqlList.add("select a.id as id , operation_code as operationCode, r.group_id as groupId ,a.operate_organize_type as operateOrganizeType ,a.group_id as specifyGroup , a.group_name as specifyGroupName from task_pool_rule_allow_out a left join task_pool_rule_group_ref r on a.rule_id = r.rule_id left join task_pool_rule ru on ru.id = a.rule_id where ru.status = 1 and r.group_id in ( #{groupId} )");
        sqlList.add("select a.task_no as taskNo, a.create_time as createTime, a.area_name as areaName, a.delivery_line_name as deliveryLineName, a.area_id as areaId, a.transfer_center_id as transferCenterId, a.transfer_center as transferCenterName, a.delivery_id as deliveryId, a.delivery as delivery, a.driver_name as driverName, a.plan_status as planStatus, s.stop_index as stopIndex, s.waybill_sort as waybillSort, s.recipient_stop as recipientStop, b.waybill_no as waybillNo from hub_assign_task a inner join hub_assign_task_waybill b on a.id = b.task_id left join hub_assign_task_stop s on a.id = s.task_id and b.waybill_no = s.waybill_no where b.waybill_no = #{waybillNo} and a.task_status in ( #{status} ) order by a.create_time desc limit 1;");
        sqlList.add("select a.task_no as taskNo, a.create_time as createTime, a.area_name as areaName, a.delivery_line_name as deliveryLineName, a.delivery as delivery, a.driver_name as driverName, a.plan_status as planStatus, a.area_id as areaId, a.transfer_center_id as transferCenterId, a.transfer_center as transferCenterName, a.delivery_id as deliveryId, b.waybill_no as waybillNo, c.waybill_sort as waybillSort, s.stop_index as stopIndex, s.recipient_stop as recipientStop from hub_assign_task a inner join hub_assign_task_waybill b on a.id = b.task_id left join route_plan_waybill c on (b.data_id = c.data_id and b.waybill_no = c.waybill_no) left join hub_assign_task_stop s on a.id = s.task_id and b.waybill_no = s.waybill_no where a.del_flag = 0 and b.waybill_no = #{waybillNo} and a.task_status in ( #{status} ) order by a.create_time desc limit 1;");
        sqlList.add("select ara.id as id, ara.name as areaName, ara.station_id as stationId, ara.station_name as stationName, ara.center_id as centerId, ara.center_name as centerName, ara.status as status, t.postcode as postCode from work_areas_freight_forwarder t left join work_areas_courier ara on t.work_areas_courier_id = ara.id where t.postcode in ( #{postcode} ) group by t.postcode");
        sqlList.add("select ara.id as id, ara.name as areaName, ara.station_id as stationId, ara.station_name as stationName, ara.center_id as centerId, ara.center_name as centerName, ara.status as status, t.postcode as postCode from work_areas_postcode t left join work_areas_courier ara on t.area_id = concat(, ara.id) where t.postcode in ( #{postcode} ) and t.type = 'COURIER' group by t.postcode");
        sqlList.add("select ara.id as id, ara.name as areaName, ara.station_id as stationId, ara.station_name as stationName, ara.center_id as centerId, ara.center_name as centerName, ara.status as status, t.postcode as postCode from work_areas_pudo_coverage t left join work_areas_courier ara on t.work_area_id = ara.id where t.postcode in ( #{postcode} ) group by t.postcode");
        sqlList.add("select ara.id, ara.name as areaCode , ara.create_dept_id as createDeptId, ara.station_id as deliveryId, ara.station_name as delivery, ara.center_id as transitCenterId, ara.center_name as transitCenterName, ara.status as enabledState, 2 as groupType, ara.lower_limit as deliveryMin, ara.upper_limit as deliveryMax, DATE_FORMAT(ara.update_time,'%H:%i:%S %d/%m/%Y') AS upDateTime, ara.update_by_name as updateByName from work_areas_courier ara, work_areas_postcode code where code.area_id = concat('E_', ara.id) and code.postcode = #{postcode} and ara.station_id=#{deliveryId} and ara.status =0 limit 1");
        sqlList.add("select ara.name from work_areas_courier ara, work_areas_postcode code where code.area_id = concat('E_', ara.id) and code.postcode = #{postcode} and ara.station_id=#{deliveryId} and ara.status =0 limit 1");
        sqlList.add("select ara.name from work_areas_courier ara, work_areas_postcode code where code.area_id = concat('E_', ara.id) and code.postcode = #{postcode} limit 1");
        sqlList.add("select config_id, config_name, config_key, config_value, config_type, create_by, create_time, update_by, update_time, remark from sys_config where config_id = #{configId} and config_key = #{configKey}");
        sqlList.add("select count(*) from hub_assign_task where del_flag = 0 and delivery_id = #{deliveryId} and delivery_day between #{dto.startDateLong} and #{dto.endDateLong} and task_status = 2");
        sqlList.add("select count(*) from hub_assign_task where del_flag = 0 and delivery_id = #{deliveryId} and delivery_day between #{dto.startDateLong} and #{dto.endDateLong} and task_status in ( #{status} )");
        sqlList.add("select count(*) from hub_assign_task where del_flag = 0 and delivery_id = #{deliveryId} and push_time between #{dto.startDate} and #{dto.endDate} and task_status in ( #{status} )");
        sqlList.add("select count(*) from route_location_log where waybill_no=#{waybillNo}");
        sqlList.add("select count(*) from route_plan_async_log where create_by=#{createBy} and create_time between #{startTime} and #{endTime} and operator_role=#{operatorRole}");
        sqlList.add("select count(distinct hatw.waybill_no) as waybillCount, (select count(distinct stop.stop_index) from hub_assign_task_stop stop where stop.task_id = #{taskId}) as stopCount, SUM(CASE WHEN hatw.received_flag = 1 THEN 1 ELSE 0 END) as receivedCount, SUM(CASE WHEN mwi.express_status = 205 THEN 1 ELSE 0 END) as deliveredCount, SUM(CASE WHEN mwi.express_status = 204 THEN 1 ELSE 0 END) as closedPositionCount, SUM(CASE WHEN mwi.express_status = 209 THEN 1 ELSE 0 END) as backSiteCount, SUM(CASE WHEN mwi.express_status = 206 THEN 1 ELSE 0 END) as failedCount, SUM(CASE WHEN mwi.express_status = 300 or mwi.express_status = 301 THEN 1 ELSE 0 END) as slCount, SUM(CASE WHEN mwi.express_status = 208 or mwi.express_status = 218 THEN 1 ELSE 0 END) deliveringCount from hub_assign_task_waybill hatw left join mis_waybill_info mwi on hatw.waybill_no = mwi.waybill_no left join hub_assign_task hat on hat.id = hatw.task_id where hat.id = #{taskId} and hat.del_flag = 0");
        sqlList.add("select count(distinct hatw.waybill_no) from hub_assign_task_waybill hatw, hub_assign_task hat where hat.del_flag = 0 and hatw.task_id = hat.id and hat.create_time between #{dto.startTime} and #{dto.endTime} and hat.transfer_center_id in ( #{centerId} )");
        sqlList.add("select count(distinct hatw.waybill_no) from hub_assign_task_waybill hatw, hub_assign_task hat where hat.del_flag = 0 and hatw.task_id = hat.id and hatw.received_flag = 1 and hat.create_time between #{dto.startTime} and #{dto.endTime} and hat.transfer_center_id in ( #{centerId} )");
        sqlList.add("select count(distinct stop.stop_index) as stopCount, stop.task_id as id from hub_assign_task_stop stop where stop.task_id in ( #{id} ) group by stop.task_id");
        sqlList.add("select count(distinct t.stop_index) from hub_assign_task_stop t where t.task_id = #{taskId}");
        sqlList.add("select distinct ea.name as areaCode from route_plan_async_log log, work_areas_courier ea where ea.status = 0 and log.area_id = ea.id and ea.id in ( #{areaId} ) and log.status!='complete'");
        sqlList.add("select distinct lgt.id as dataId from route_plan_async_log lot left join route_plan_async_data lgt on lot.id = lgt.log_id where lot.operator_role = 'manager' and lot.status='complete' and lot.dept_id=#{vo.deptId} and lgt.id=#{vo.dateId} and lot.del_flag=0 order by lot.create_time desc");
        sqlList.add("select distinct mpdr.package_no as packageNo from mis_package_dept_ref mpdr force index(idx_destin_center_create_time), mis_waybill_info mwi where mpdr.package_no = mwi.package_no and mwi.target_center_id=#{targetCenterId} and mwi.express_status in(100, 217) and mpdr.create_time between #{createStartTime} and #{createEndTime} and mpdr.destin_center_id=#{targetCenterId}");
        sqlList.add("select distinct mwi.driver_id as driverId, way.data_id as dataId from route_plan_waybill way, mis_waybill_info mwi where way.waybill_no = mwi.waybill_no and way.data_id in( #{dataId} ) and mwi.driver_id is not null and mwi.driver_id !=''");
        sqlList.add("select distinct mwi.package_no as packageNo, hatw.task_id as id from hub_assign_task_waybill hatw, mis_waybill_info mwi where hatw.waybill_no = mwi.waybill_no and task_id in( #{taskId} )");
        sqlList.add("select distinct t.postcode from work_areas_freight_forwarder t where t.work_areas_courier_id = #{areaId}");
        sqlList.add("select distinct t.postcode from work_areas_postcode t where t.area_id=concat('E_', #{areaId})");
        sqlList.add("select distinct t.postcode from work_areas_pudo_coverage t where t.work_area_id = #{areaId}");
        sqlList.add("select distinct waybill_no from hub_assign_task_waybill hatw where task_id in ( #{taskId} )");
        sqlList.add("select hat.bag_count as bagCount, hat.waybill_count as waybillCount, hat.delivery_line_name as deliveryLineName, hat.driver_id as driverId, hat.driver_name as driverName, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.transfer_center_id as transferCenterId, hat.id as taskId from hub_assign_task hat where id = #{taskId}");
        sqlList.add("select hat.bag_count as bagCount, hat.waybill_count as waybillCount, hat.delivery_line_name as deliveryLineName, hat.driver_id as driverId, hat.driver_name as driverName, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.transfer_center_id as transferCenterId, hat.id as taskId, hat.task_no as taskNo, hat.delivery_day as deliveryDay from hub_assign_task hat where id in( #{taskId} )");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.p_task_no as pTaskNo, hat.o_task_no as oTaskNo, hat.task_status as taskStatus, hat.to_code as toCode, hat.plan_status as planStatus, hat.plan_code as planCode, hat.area_id as areaId, hat.area_name as areaName, hat.sequence_no as sequenceNo, hat.plan_sorting_time as planSortingTimeLong, hat.create_time as createTime, hat.create_by as createBy, hat.create_by_name as createByName, hat.create_dept_id as createDeptId, hat.create_dept_name as createDeptName, hat.recipient_id as recipientId, hat.recipient_name as recipientName, hat.recipient_dept_id as recipientDeptId, hat.recipient_dept_name as recipientDeptName, hat.recipient_date as recipientDate, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.driver_id as driverId, hat.driver_name as driverName, hat.waybill_count as waybillCount, hat.update_by as updateBy, hat.update_by_name as updateByName, hat.update_time as updateByTime, hat.transfer_center_id as transferCenterId, hat.transfer_center as transferCenter, hat.push_time as pushTime, hat.push_user_id as pushUserId, hat.push_user_name as pushUserName, hat.generate_style as generateStyle, hat.generate_rule as generateRule, hat.delivery_mode as deliveryMode, hat.delivery_day as deliveryDay, hat.delivery_line_name as deliveryLineName, hat.bag_count as bagCount, hat.delivery_day_count as deliveryDayCount, hat.task_split_mode as taskSplitMode from hub_assign_task hat where hat.del_flag = 0 and hat.task_no in ( #{taskNo} ) and hat.p_task_no like concat('%', #{dto.parentTaskNo}, '%') and hat.o_task_no = #{dto.oriTaskNo} and hat.plan_code in ( #{planCode} ) and hat.task_status in ( #{taskStatus} ) and hat.delivery_id in ( #{deliveryId} ) and hat.area_id in ( #{areaId} ) and hat.driver_id in ( #{driverId} ) and hat.bag_count <= #{dto.waybillCountMax} and hat.bag_count >= #{dto.waybillCountMin} and hat.plan_status in ( #{planStatus} ) and hat.transfer_center_id in ( #{filterCenterId} ) and hat.transfer_center_id in ( #{centerId} ) and hat.id in ( #{id} ) and hat.id in ( select distinct hatw.task_id from hub_assign_task_waybill hatw where hatw.waybill_no in ( #{waybillNo} ) ) and hat.plan_sorting_time = #{dto.planSortingTimeLong} AND hat.push_time between #{dto.startTime} and #{dto.endTime} AND hat.recipient_date between #{dto.startTime} and #{dto.endTime} AND hat.create_time between #{dto.startTime} and #{dto.endTime} AND hat.plan_sorting_time >= #{dto.startTimeLong} AND hat.plan_sorting_time <= #{dto.endTimeLong} order by hat.id desc");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.p_task_no as pTaskNo, hat.o_task_no as oTaskNo, hat.task_status as taskStatus, hat.to_code as toCode, hat.plan_status as planStatus, hat.plan_code as planCode, hat.area_id as areaId, hat.area_name as areaName, hat.sequence_no as sequenceNo, hat.plan_sorting_time as planSortingTimeLong, hat.create_time as createTime, hat.create_by as createBy, hat.create_by_name as createByName, hat.create_dept_id as createDeptId, hat.create_dept_name as createDeptName, hat.recipient_id as recipientId, hat.recipient_name as recipientName, hat.recipient_dept_id as recipientDeptId, hat.recipient_dept_name as recipientDeptName, hat.recipient_date as recipientDate, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.driver_id as driverId, hat.driver_name as driverName, hat.waybill_count as waybillCount, hat.update_by as updateBy, hat.update_by_name as updateByName, hat.update_time as updateByTime, hat.transfer_center_id as transferCenterId, hat.transfer_center as transferCenter, hat.push_time as pushTime, hat.push_user_id as pushUserId, hat.push_user_name as pushUserName, hat.generate_style as generateStyle, hat.generate_rule as generateRule, hat.delivery_mode as deliveryMode, hat.delivery_day as deliveryDay, hat.delivery_line_name as deliveryLineName, hat.bag_count as bagCount, hat.delivery_day_count as deliveryDayCount, hat.task_split_mode as taskSplitMode from hub_assign_task hat where hat.del_flag = 0 and hat.task_no in ( #{taskNo} ) and hat.p_task_no like concat('%', #{dto.parentTaskNo}, '%') and hat.o_task_no = #{dto.oriTaskNo} and hat.plan_code in ( #{planCode} ) and hat.task_status in ( #{taskStatus} ) and hat.delivery_id in ( #{deliveryId} ) and hat.area_id in ( #{areaId} ) and hat.driver_id in ( #{driverId} ) and hat.bag_count <= #{dto.waybillCountMax} and hat.bag_count >= #{dto.waybillCountMin} and hat.plan_status in ( #{planStatus} ) and hat.transfer_center_id in ( #{filterCenterId} ) and hat.transfer_center_id in ( #{centerId} ) and hat.id in ( #{id} ) and hat.id in ( select distinct hatw.task_id from hub_assign_task_waybill hatw where hatw.waybill_no in ( #{waybillNo} ) ) and hat.plan_sorting_time = #{dto.planSortingTimeLong} AND hat.push_time between #{dto.startTime} and #{dto.endTime} AND hat.recipient_date between #{dto.startTime} and #{dto.endTime} AND hat.create_time between #{dto.startTime} and #{dto.endTime} AND hat.plan_sorting_time >= #{dto.startTimeLong} AND hat.plan_sorting_time <= #{dto.endTimeLong} order by hat.id desc");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.area_id as areaId, hat.area_name as areaName, hat.waybill_count as waybillCount, (select count(*) from hub_assign_task_waybill hatw where hatw.task_id = hat.id and received_flag = 0) as unclaimedCount, case when hat.task_status=3 then hat.recipient_id else hat.driver_id end driverId, case when hat.task_status=3 then hat.recipient_name else hat.driver_name end driverName, hat.delivery_line_name as deliveryLineName, hat.transfer_center as transferCenter from hub_assign_task hat where hat.delivery_id=#{deliveryId} AND hat.del_flag = 0 and hat.push_time between #{dto.startDate} and #{dto.endDate} and hat.task_status in(2,3,7,8) and hat.driver_id = #{dto.courierId} order by hat.task_status,hat.id desc");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.area_id as areaId, hat.area_name as areaName, hat.waybill_count as waybillCount, (select count(*) from hub_assign_task_waybill hatw where hatw.task_id = hat.id and received_flag = 0) as unclaimedCount, case when hat.task_status=3 then hat.recipient_id else hat.driver_id end driverId, case when hat.task_status=3 then hat.recipient_name else hat.driver_name end driverName, hat.delivery_line_name as deliveryLineName, hat.transfer_center as transferCenter from hub_assign_task hat where hat.delivery_id=#{deliveryId} AND hat.del_flag = 0 and hat.delivery_day between #{dto.startDateLong} and #{dto.endDateLong} and hat.task_status in(2,3,7,8) and hat.driver_id = #{dto.courierId} order by hat.push_time desc");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.plan_status as planStatus, hat.area_name as areaName, hat.create_time as createTime, hat.create_by_name as createByName, hat.recipient_name as recipientName, hat.recipient_date as recipientDate, hat.delivery as delivery, hat.driver_name as driverName, hat.transfer_center as transferCenter, hat.push_time as pushTime, hat.push_user_name as pushUserName, hatw.waybill_no as waybillNo , hatw.id as wId, hatw.to_code as waybillPostCode, hatw.received_flag as receivedFlag, hatw.bag_flag as bagFlag, hat.plan_code as planCode, hat.sequence_no as sequenceNo, hat.plan_sorting_time as planSortingTimeLong, hat.generate_style as generateStyle, hat.generate_rule as generateRule, hat.delivery_mode as deliveryMode, hat.delivery_day as deliveryDay, hat.delivery_line_name as deliveryLineName, hat.bag_count as bagCount, hat.delivery_day_count as deliveryDayCount from hub_assign_task hat inner join hub_assign_task_waybill hatw on hat.id = hatw.task_id where hat.del_flag = 0 and hat.task_no in ( #{taskNo} ) and hat.plan_code in ( #{planCode} ) and hat.task_status in ( #{taskStatus} ) and hat.delivery_id in ( #{deliveryId} ) and hat.area_id in ( #{areaId} ) and hat.driver_id in ( #{driverId} ) and hat.bag_count <= #{dto.waybillCountMax} and hat.bag_count >= #{dto.waybillCountMin} and hat.plan_status in ( #{planStatus} ) and hat.transfer_center_id in ( #{filterCenterId} ) and hat.transfer_center_id in ( #{centerId} ) and hat.id in ( #{id} ) and hatw.waybill_no in ( #{waybillNo} ) AND hat.push_time between #{dto.startTime} and #{dto.endTime} AND hat.recipient_date between #{dto.startTime} and #{dto.endTime} AND hat.create_time between #{dto.startTime} and #{dto.endTime} AND hat.plan_sorting_time >= #{dto.startTimeLong} AND hat.plan_sorting_time <= #{dto.endTimeLong} order by hat.id desc");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.plan_status as planStatus, hat.area_name as areaName, hat.create_time as createTime, hat.create_by_name as createByName, hat.recipient_name as recipientName, hat.recipient_date as recipientDate, hat.delivery as delivery, hat.driver_name as driverName, hat.transfer_center as transferCenter, hat.push_time as pushTime, hat.push_user_name as pushUserName, hatw.waybill_no as waybillNo , hatw.id as wId, hatw.to_code as waybillPostCode, hatw.received_flag as receivedFlag, hatw.bag_flag as bagFlag, hat.plan_code as planCode, hat.sequence_no as sequenceNo, hat.plan_sorting_time as planSortingTimeLong, hat.generate_style as generateStyle, hat.generate_rule as generateRule, hat.delivery_mode as deliveryMode, hat.delivery_day as deliveryDay, hat.delivery_line_name as deliveryLineName, hat.bag_count as bagCount, hat.delivery_day_count as deliveryDayCount from hub_assign_task hat inner join hub_assign_task_waybill hatw on hat.id = hatw.task_id where hat.del_flag = 0 and hat.task_no in ( #{taskNo} ) and hat.plan_code in ( #{planCode} ) and hat.task_status in ( #{taskStatus} ) and hat.delivery_id in ( #{deliveryId} ) and hat.area_id in ( #{areaId} ) and hat.driver_id in ( #{driverId} ) and hat.bag_count <= #{dto.waybillCountMax} and hat.bag_count >= #{dto.waybillCountMin} and hat.plan_status in ( #{planStatus} ) and hat.transfer_center_id in ( #{filterCenterId} ) and hat.transfer_center_id in ( #{centerId} ) and hat.id in ( #{id} ) and hatw.waybill_no in ( #{waybillNo} ) AND hat.push_time between #{dto.startTime} and #{dto.endTime} AND hat.recipient_date between #{dto.startTime} and #{dto.endTime} AND hat.create_time between #{dto.startTime} and #{dto.endTime} AND hat.plan_sorting_time >= #{dto.startTimeLong} AND hat.plan_sorting_time <= #{dto.endTimeLong} order by hat.id desc");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.to_code as toCode, hat.bag_count as bagCount, hat.create_time as createTime, hat.delivery_day as deliveryDay, hat.push_time as pushTime, hat.waybill_count as waybillCount, hat.transfer_center_id as transferCenterId, hat.delivery_line_name as deliveryLineName from hub_assign_task hat where hat.driver_id = #{dto.driverId} and hat.delivery_id = #{dto.deliveryId} and hat.task_status in (2) and hat.del_flag = 0 and hat.push_time between #{dto.startTime} and #{dto.endTime} order by hat.push_time DESC");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.to_code as toCode, hat.plan_status as planStatus, hat.plan_code as planCode, hat.area_id as areaId, hat.area_name as areaName, hat.sequence_no as sequenceNo, hat.plan_sorting_time as planSortingTimeLong, hat.create_time as createTime, hat.create_by as createBy, hat.create_by_name as createByName, hat.create_dept_id as createDeptId, hat.create_dept_name as createDeptName, hat.recipient_id as recipientId, hat.recipient_name as recipientName, hat.recipient_dept_id as recipientDeptId, hat.recipient_dept_name as recipientDeptName, hat.recipient_date as recipientDate, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.driver_id as driverId, hat.driver_name as driverName, hat.waybill_count as waybillCount, hat.box_no as boxNo, hat.update_by as updateBy, hat.update_by_name as updateByName, hat.update_time as updateByTime, hat.transfer_center_id as transferCenterId, hat.transfer_center as transferCenter, hat.push_time as pushTime, hat.push_user_id as pushUserId, hat.push_user_name as pushUserName, hat.generate_style as generateStyle, hat.generate_rule as generateRule, hat.delivery_day as deliveryDay, hat.delivery_line_name as deliveryLineName from hub_assign_task hat where hat.id in ( #{id} ) and task_status = 5 and plan_Status = 3");
        sqlList.add("select hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.to_code as toCode, hat.plan_status as planStatus, hat.plan_code as planCode, hat.area_id as areaId, hat.area_name as areaName, hat.sequence_no as sequenceNo, hat.plan_sorting_time as planSortingTimeLong, hat.create_time as createTime, hat.create_by as createBy, hat.create_by_name as createByName, hat.create_dept_id as createDeptId, hat.create_dept_name as createDeptName, hat.recipient_id as recipientId, hat.recipient_name as recipientName, hat.recipient_dept_id as recipientDeptId, hat.recipient_dept_name as recipientDeptName, hat.recipient_date as recipientDate, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.driver_id as driverId, hat.driver_name as driverName, hat.waybill_count as waybillCount, hat.box_no as boxNo, hat.update_by as updateBy, hat.update_by_name as updateByName, hat.update_time as updateByTime, hat.transfer_center_id as transferCenterId, hat.transfer_center as transferCenter, (select count(*) from hub_assign_task_waybill hatw where hatw.task_id = hat.id and received_flag = 1) as receivedCount, (select count(*) from hub_assign_task_waybill hatw where hatw.task_id = hat.id and received_flag = 0) as unclaimedCount, hat.bag_count as bagCount, hat.push_time as pushTime, hat.push_user_id as pushUserId, hat.push_user_name as pushUserName, hat.generate_style as generateStyle, hat.generate_rule as generateRule, hat.delivery_mode as deliveryMode, hat.delivery_day as deliveryDay, hat.delivery_line_name as deliveryLineName from hub_assign_task hat where hat.id in ( #{id} )");
        sqlList.add("select hats.id as id, hats.task_id as taskId, hats.task_no as taskNo, hats.stop_index as stopIndex, hats.sindex as sindex, hats.lot_number as lotNumber, hats.recipient_stop as recipient, hats.waybill_sort as waybillSort, hats.full_stop as fullStop, hats.format_address as formatAddress, hats.finance_format_address as financeFormatAddress, hats.stop_model as stopModel, hats.delivery_format_address as deliveryFormatAddress, hats.waybill_no as waybillNo, hat.delivery_id as deliveryId from hub_assign_task_stop hats left join hub_assign_task hat on hats.task_id = hat.id where hats.task_id = #{taskId}");
        sqlList.add("select hatw.id, hatw.task_id as taskId, hatw.waybill_no as waybillNo, hatw.box_no as boxNo, hatw.to_code as toCode, hatw.data_id as dataId, hatw.received_flag as receivedFlag, hatw.bag_flag as bagFlag, hatw.plan_arrival_time as planArrivalTime, hatw.plan_sorting_time as planSortingTime from hub_assign_task_waybill hatw where hatw.task_id in ( #{taskId} ) order by hatw.received_flag");
        sqlList.add("select hatw.id, hatw.task_id as taskId, hatw.waybill_no as waybillNo, hatw.box_no as boxNo, hatw.to_code as toCode, hatw.data_id as dataId, hatw.received_flag as receivedFlag, hatw.bag_flag as bagFlag, hatw.plan_arrival_time as planArrivalTime, hatw.plan_sorting_time as planSortingTime, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.area_id as areaId, hat.area_name as areaName, hat.delivery_line_name as deliveryLineName, hatw.recipient_id as recipientId, hatw.recipient_name as recipientName from hub_assign_task_waybill hatw LEFT JOIN hub_assign_task hat on hat.id = hatw.task_id where hatw.task_id = hat.id and hatw.task_id=#{taskId} and hatw.received_flag = #{receivedFlag} and hatw.bag_flag = #{bagFlag} and hatw.waybill_no in ( #{waybillNo} ) order by hatw.received_flag asc");
        sqlList.add("select hatw.id, hatw.task_id as taskId, hatw.waybill_no as waybillNo, hatw.box_no as boxNo, hatw.to_code as toCode, hatw.data_id as dataId, hatw.received_flag as receivedFlag, hatw.bag_flag as bagFlag, hatw.plan_arrival_time as planArrivalTime, hatw.plan_sorting_time as planSortingTime, hat.transfer_center_id as transferCenterId, hat.transfer_center as transferCenter, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.area_id as areaId, hat.area_name as areaName, hat.delivery_line_name as deliveryLineName from hub_assign_task_waybill hatw LEFT JOIN hub_assign_task hat on hat.id = hatw.task_id where hatw.task_id = hat.id and hatw.task_id = #{taskId} and hatw.received_flag = #{receivedFlag} and hatw.bag_flag = #{bagFlag} and hatw.waybill_no in ( #{waybillNo} ) order by hatw.received_flag");
        sqlList.add("select hatw.id, hatw.task_id as taskId, hatw.waybill_no as waybillNo, hatw.box_no as boxNo, hatw.to_code as toCode, hatw.data_id as dataId, hatw.received_flag as receivedFlag, hatw.bag_flag as bagFlag, hatw.plan_arrival_time as planArrivalTime, hatw.plan_sorting_time as planSortingTime, hat.transfer_center_id as transferCenterId, hat.transfer_center as transferCenter, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.area_id as areaId, hat.area_name as areaName, hat.delivery_line_name as deliveryLineName from hub_assign_task_waybill hatw LEFT JOIN hub_assign_task hat on hat.id = hatw.task_id where hatw.task_id = hat.id and hatw.task_id = #{taskId} and (hatw.bag_flag != 1 or hatw.bag_flag is null) order by hatw.received_flag");
        sqlList.add("select hatw.id, hatw.task_id as taskId, hatw.waybill_no as waybillNo, hatw.to_code as toCode, hatw.data_id as dataId, hatw.received_flag as receivedFlag, hatw.bag_flag as bagFlag, hat.waybill_sort as waybillSort, hat.data_type as dataType, htask.driver_id as driverId, htask.driver_name as driverName, st.stop_index as stopIndex from hub_assign_task_waybill hatw left join route_plan_waybill hat on hat.waybill_no = hatw.waybill_no and hat.data_id = hatw.data_id LEFT JOIN hub_assign_task htask on htask.id = hatw.task_id left join hub_assign_task_stop st on st.waybill_no = hatw.waybill_no and st.task_id = hatw.task_id where hatw.task_id = #{taskId} and hatw.received_flag = #{receivedFlag} and bag_flag = 1 and hatw.waybill_no in ( #{waybillNo} ) and hat.data_type = #{routePlanResult} order by hat.waybill_sort");
        sqlList.add("select hatw.id, hatw.task_id as taskId, hatw.waybill_no as waybillNo, hatw.to_code as toCode, hatw.data_id as dataId, hatw.received_flag as receivedFlag, hatw.bag_flag as bagFlag, hat.waybill_sort as waybillSort, hat.data_type as dataType, mw.express_status as expressStatus, mw.to_street as toStreet, mw.to_city as toCity, mw.longitude as longitude, mw.latitude as latitude, mw.package_no as boxNo, mw.to_code as toSampleCode, htask.driver_id as driverId, htask.driver_name as driverName, st.stop_index as stopIndex from hub_assign_task_waybill hatw left join mis_waybill_info mw on hatw.waybill_no = mw.waybill_no left join route_plan_waybill hat on hat.waybill_no = hatw.waybill_no and hat.data_id = hatw.data_id LEFT JOIN hub_assign_task htask on htask.id = hatw.task_id left join hub_assign_task_stop st on st.waybill_no = hatw.waybill_no and st.task_id = hatw.task_id where hatw.task_id = #{taskId} and hatw.received_flag = #{receivedFlag} and bag_flag = 1 and hatw.waybill_no in ( #{waybillNo} ) and hat.data_type = #{routePlanResult} order by hat.waybill_sort asc");
        sqlList.add("select hatw.task_id as taskId, hatw.delivery_id as deliveryId from hub_assign_task_waybill hatw where hatw.task_id in ( #{taskId} ) group by task_id");
        sqlList.add("select hatw.waybill_no as waybillNo, hat.area_name as areaName, hat.delivery as delivery, hatw.to_code as postCode, hatw.bag_flag as bagFlag, hatw.received_flag as receivedFlag, hatw.recipient_id as recipientId, hatw.recipient_name as recipientName from hub_assign_task_waybill hatw, hub_assign_task hat where hatw.task_id = hat.id and hatw.task_id = #{taskId} and hatw.bag_flag = 1 and hatw.received_flag = #{receivedFlag};");
        sqlList.add("select hatw.waybill_no as waybillNo, hat.area_name as areaName, hat.delivery as delivery, hatw.to_code as postCode, hatw.bag_flag as bagFlag, hatw.received_flag as receivedFlag, hatw.recipient_id as recipientId, hatw.recipient_name as recipientName from hub_assign_task_waybill hatw, hub_assign_task hat where hatw.task_id = hat.id and hatw.task_id = #{taskId} and hatw.received_flag = #{receivedFlag};");
        sqlList.add("select hatw.waybill_no as waybillNo, mwi.longitude as longitude, mwi.latitude as latitude, mwi.to_code as toCode, mwi.to_street as toStreet, mwi.express_Status as expressStatus, pw.waybill_sort as waybillSort, mwi.update_by as driverId, mwi.update_by_name as driverName, hats.stop_index as stop, hats.sindex as stopSindex from hub_assign_task_waybill hatw left join mis_waybill_info mwi on hatw.waybill_no = mwi.waybill_no left join hub_assign_task hat on hat.id = hatw.task_id left join route_plan_waybill pw on pw.waybill_no = hatw.waybill_no and pw.data_id = hatw.data_id left join hub_assign_task_stop hats on hats.waybill_no = hatw.waybill_no and hats.task_id = hat.id where hat.id = #{dto.taskId} and hat.task_status in (2, 3, 7, 8) and hatw.waybill_no = #{dto.waybillNo} and mwi.to_street like concat(#{dto.address}, '%') and mwi.to_code = #{dto.postcode} and mwi.express_Status in ( #{expressStatus} )");
        sqlList.add("select hatw.waybill_no as waybillNo,hub.id as id,sign.status_update_time as signDate from hub_assign_task_waybill hatw left join hub_assign_task hub on hatw.task_id = hub.id left join mis_waybill_info sign on sign.waybill_no = hatw.waybill_no where hub.id in ( #{id} ) and sign.express_status = 205 and hatw.received_flag = 1");
        sqlList.add("select hwp.add_type as addType, count(*) as waybillCount from hub_box_pool pool, hub_waybill_pool hwp, mis_waybill_info mwi where pool.box_no = hwp.box_no and hwp.waybill_no = mwi.waybill_no and mwi.express_status != 205 and pool.box_no in ( #{item} ) and pool.create_time between #{dto.startTime} and #{dto.endTime} and pool.allocation_Status=#{dto.allocationStatus} and pool.line_name like concat('%',#{dto.lineName},'%') and pool.transfer_center_id in ( #{filterCenterId} ) and pool.transfer_center_id in ( #{centerId} ) group by hwp.add_type");
        sqlList.add("select hwp.box_no as boxNo from hub_waybill_pool hwp where hwp.box_no in ( #{boxNo} )");
        sqlList.add("select hwp.id as id, hwp.waybill_no as waybillNo, hwp.box_no as boxNo, hwp.dept_id as deliveryId, hwp.delivery as deliveryName, hwp.plan_status as planStatus, hwp.create_time as createTime, hwp.plan_arrival_time as planArrivalTimeLong, hwp.plan_sorting_time as planSortingTimeLong, hwp.add_type as addType, hwp.transfer_center_name as transferCenter, hwp.exception_type as exceptionType, hwp.to_code as toCode, hwp.to_expand_code as toExpandCode, hwp.express_status as waybillStatus, hwp.create_by_name as createByName, hwp.create_dept_name as createDeptName, hwp.data_source as dataSource, GROUP_CONCAT(distinct (t.name) separator ',') as areaName, GROUP_CONCAT(distinct (d.courier_name) separator ',') as courierName, hwp.to_code as postCode, hwp.return_flag as returnFlag, hwp.address_type_view as addressType from hub_waybill_pool hwp left join work_areas_courier t on t.station_id = hwp.dept_id and t.name = hwp.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = t.id and d.personnel_type = 1 where hwp.express_status != '205' and hwp.waybill_no in ( #{waybill} ) and hwp.box_no in ( #{boxNo} ) and hwp.dept_id in ( #{deliveryId} ) and hwp.plan_status in ( #{status} ) and hwp.exception_type in ( #{item} ) and hwp.express_status in ( #{item} ) and t.id in ( #{item} ) and d.courier_id in ( #{item} ) and hwp.data_source in ( #{item} ) and hwp.create_dept_id in ( #{item} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.plan_arrival_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.plan_sorting_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.transfer_center_id in ( #{filterCenterId} ) and hwp.transfer_center_id in ( #{centerId} ) and exists( select 1 from work_areas_postcode rddp where rddp.area_id in( concat('E_', #{item}) ) and rddp.postcode=hwp.to_code and rddp.`type` = 'COURIER' ) and hwp.to_code in ( #{item} ) and hwp.address_type in ( #{item} ) group by hwp.waybill_no order by hwp.id desc");
        sqlList.add("select hwp.id as id, hwp.waybill_no as waybillNo, hwp.box_no as boxNo, mwi.dept_id as deliveryId, mwi.delivery as deliveryName, hwp.plan_status as planStatus, hwp.create_time as createTime, hwp.plan_arrival_time as planArrivalTimeLong, hwp.plan_sorting_time as planSortingTimeLong, hwp.add_type as addType, hwp.transfer_center_name as transferCenter, hwp.exception_type as exceptionType, mwi.to_code as toCode, mwi.to_expand_code as toExpandCode, mwi.express_status as waybillStatus, hwp.create_by_name as createByName, hwp.create_dept_name as createDeptName, hwp.data_source as dataSource, GROUP_CONCAT(distinct (t.name) separator ',') as areaName, GROUP_CONCAT(distinct (d.courier_name) separator ',') as courierName, mwi.to_code as postCode from hub_waybill_pool hwp left join mis_waybill_info mwi on hwp.waybill_no = mwi.waybill_no LEFT JOIN work_areas_courier t ON t.station_id = CASE WHEN mwi.dept_id REGEXP '^[0-9]+$' and mwi.dept_id != '' THEN CAST(mwi.dept_id AS UNSIGNED) ELSE NULL END AND t.name = mwi.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = t.id and d.personnel_type = 1 where hwp.waybill_no = mwi.waybill_no and mwi.express_status!='205' and hwp.waybill_no in ( #{waybill} ) and hwp.box_no in ( #{boxNo} ) and mwi.dept_id in ( #{deliveryId} ) and hwp.plan_status in ( #{status} ) and hwp.exception_type in ( #{item} ) and mwi.express_status in ( #{item} ) and t.id in ( #{item} ) and d.courier_id in ( #{item} ) and hwp.data_source in ( #{item} ) and hwp.create_dept_id in ( #{item} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.plan_arrival_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.plan_sorting_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.transfer_center_id in ( #{filterCenterId} ) and hwp.transfer_center_id in ( #{centerId} ) and exists( select 1 from work_areas_postcode rddp where rddp.area_id in( concat('E_', #{item}) ) and rddp.postcode=hwp.to_code and rddp.`type` = 'COURIER' ) and hwp.to_code in ( #{item} ) group by hwp.waybill_no order by hwp.id desc");
        sqlList.add("select hwp.id as id, hwp.waybill_no as waybillNo, hwp.box_no as boxNo, mwi.dept_id as deliveryId, mwi.delivery as deliveryName, hwp.plan_status as planStatus, hwp.create_time as createTime, hwp.plan_arrival_time as planArrivalTimeLong, hwp.plan_sorting_time as planSortingTimeLong, hwp.add_type as addType, hwp.transfer_center_name as transferCenter, hwp.exception_type as exceptionType, mwi.to_code as toCode, mwi.to_expand_code as toExpandCode, mwi.express_status as waybillStatus, hwp.create_by_name as createByName, hwp.create_dept_name as createDeptName, hwp.data_source as dataSource, GROUP_CONCAT(distinct (t.name) separator ',') as areaName, GROUP_CONCAT(distinct (d.courier_name) separator ',') as courierName, mwi.to_code as postCode from hub_waybill_pool hwp left join mis_waybill_info mwi on hwp.waybill_no = mwi.waybill_no LEFT JOIN work_areas_courier t ON t.station_id = CASE WHEN mwi.dept_id REGEXP '^[0-9]+$' and mwi.dept_id != '' THEN CAST(mwi.dept_id AS UNSIGNED) ELSE NULL END AND t.name = mwi.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = t.id and d.personnel_type = 1 where hwp.waybill_no = mwi.waybill_no and mwi.express_status!='205' and hwp.waybill_no in ( #{waybill} ) and hwp.box_no in ( #{boxNo} ) and mwi.dept_id in ( #{deliveryId} ) and hwp.plan_status in ( #{status} ) and hwp.exception_type in ( #{item} ) and mwi.express_status in ( #{item} ) and t.id in ( #{item} ) and d.courier_id in ( #{item} ) and hwp.data_source in ( #{item} ) and hwp.create_dept_id in ( #{item} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.plan_arrival_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.plan_sorting_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.transfer_center_id in ( #{filterCenterId} ) and hwp.transfer_center_id in ( #{centerId} ) and exists( select 1 from work_areas_postcode rddp where rddp.area_id in( concat('E_', #{item}) ) and rddp.postcode=hwp.to_code and rddp.`type` = 'COURIER' ) and hwp.to_code in ( #{item} ) group by hwp.waybill_no order by hwp.id desc");
        sqlList.add("select hwp.id, hwp.waybill_no as waybillNo, hwp.box_no as boxNo, hwp.plan_sorting_time as planSortingTimeLong, hwp.plan_arrival_time as planArrivalTimeLong, hwp.dept_id as deliveryId, hwp.to_code as toCode, hwp.add_type as addType from hub_waybill_pool hwp where hwp.transfer_center_id = #{transferCenterId} and hwp.waybill_no in ( #{waybill} ) order by hwp.box_no,toCode");
        sqlList.add("select hwp.waybill_no as waybillNo, hwp.id as id, count(distinct hwp.waybill_no) as total, GROUP_CONCAT(distinct (IFNULL (hwp.box_no,'')) SEPARATOR ',') as boxList, GROUP_CONCAT(distinct (hwp.dept_id ) separator ',') as deliveryId, GROUP_CONCAT(distinct (hwp.delivery ) separator ',') as deliveryName, GROUP_CONCAT(distinct (rdda.name) separator ',') as areaName, GROUP_CONCAT(distinct (IFNULL (rdda.id,-1)) separator ',') as areaId, GROUP_CONCAT(distinct (hwp.transfer_center_name) separator ',') as transferCenterStr, GROUP_CONCAT(distinct (hwp.transfer_center_id) separator ',') as transferCenterIdStr, GROUP_CONCAT(distinct (hwp.to_code) separator ',') as toCode from hub_waybill_pool hwp left join work_areas_courier rdda on rdda.station_id = hwp.dept_id and rdda.name = hwp.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = rdda.id and d.personnel_type = 1 where hwp.express_status!='205' and hwp.to_code in ( #{toCode} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.create_dept_id in ( #{item} ) and hwp.transfer_center_id in ( #{transferCenterId} ) and hwp.transfer_center_id in ( #{filterCenterId} ) and rdda.id in ( #{areaId} ) and hwp.dept_id in ( #{deliveryId} ) and hwp.box_no in ( #{boxNo} ) group by hwp.to_code group by rdda.id group by hwp.dept_id group by hwp.box_no");
        sqlList.add("select hwp.waybill_no as waybillNo, hwp.id as id, count(distinct hwp.waybill_no) as total, GROUP_CONCAT(distinct (IFNULL (hwp.box_no,'')) SEPARATOR ',') as boxList, GROUP_CONCAT(distinct (mwi.dept_id ) separator ',') as deliveryId, GROUP_CONCAT(distinct (mwi.delivery ) separator ',') as deliveryName, GROUP_CONCAT(distinct (rdda.name) separator ',') as areaName, GROUP_CONCAT(distinct (IFNULL (rdda.id,-1)) separator ',') as areaId, GROUP_CONCAT(distinct (hwp.transfer_center_name) separator ',') as transferCenterStr, GROUP_CONCAT(distinct (hwp.transfer_center_id) separator ',') as transferCenterIdStr, GROUP_CONCAT(distinct (hwp.to_code) separator ',') as toCode from hub_waybill_pool hwp left join mis_waybill_info mwi on hwp.waybill_no = mwi.waybill_no LEFT JOIN work_areas_courier rdda ON rdda.station_id = CASE WHEN mwi.dept_id REGEXP '^[0-9]+$' and mwi.dept_id != '' THEN CAST(mwi.dept_id AS UNSIGNED) ELSE NULL END AND rdda.name = mwi.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = rdda.id and d.personnel_type = 1 where mwi.express_status!='205' and hwp.waybill_no = mwi.waybill_no and hwp.to_code in ( #{toCode} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.create_dept_id in ( #{item} ) and hwp.transfer_center_id in ( #{transferCenterId} ) and hwp.transfer_center_id in ( #{filterCenterId} ) and rdda.id in ( #{areaId} ) and mwi.dept_id in ( #{deliveryId} ) and hwp.box_no in ( #{boxNo} ) group by hwp.to_code group by rdda.id group by mwi.dept_id group by hwp.box_no");
        sqlList.add("select hwp.waybill_no as waybillNo, hwp.id as id, count(distinct hwp.waybill_no) as total, GROUP_CONCAT(distinct (IFNULL (hwp.box_no,'')) SEPARATOR ',') as boxList, GROUP_CONCAT(distinct (mwi.dept_id ) separator ',') as deliveryId, GROUP_CONCAT(distinct (mwi.delivery ) separator ',') as deliveryName, GROUP_CONCAT(distinct (rdda.name) separator ',') as areaName, GROUP_CONCAT(distinct (IFNULL (rdda.id,-1)) separator ',') as areaId, GROUP_CONCAT(distinct (hwp.transfer_center_name) separator ',') as transferCenterStr, GROUP_CONCAT(distinct (hwp.transfer_center_id) separator ',') as transferCenterIdStr, GROUP_CONCAT(distinct (hwp.to_code) separator ',') as toCode from hub_waybill_pool hwp left join mis_waybill_info mwi on hwp.waybill_no = mwi.waybill_no LEFT JOIN work_areas_courier rdda ON rdda.station_id = CASE WHEN mwi.dept_id REGEXP '^[0-9]+$' and mwi.dept_id != '' THEN CAST(mwi.dept_id AS UNSIGNED) ELSE NULL END AND rdda.name = mwi.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = rdda.id and d.personnel_type = 1 where mwi.express_status!='205' and hwp.waybill_no = mwi.waybill_no and hwp.to_code in ( #{toCode} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.create_dept_id in ( #{item} ) and hwp.transfer_center_id in ( #{transferCenterId} ) and hwp.transfer_center_id in ( #{filterCenterId} ) and rdda.id in ( #{areaId} ) and mwi.dept_id in ( #{deliveryId} ) and hwp.box_no in ( #{boxNo} ) group by hwp.to_code group by rdda.id group by mwi.dept_id group by hwp.box_no");
        sqlList.add("select hwp.waybill_no as waybillNo, hwp.to_expand_code as toCode, hwp.to_code as toSampleCode, hwp.data_source as type, hwp.transfer_center_id as transferCenterId, hwp.transfer_center_name as transferCenterName, hwp.box_no as boxNo, hwp.delivery as delivery, hwp.dept_id as deliveryId, t.id as areaId from hub_waybill_pool hwp left join work_areas_courier t on t.station_id = hwp.dept_id and t.name = hwp.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = t.id where hwp.express_status != '205' and hwp.waybill_no in ( #{waybill} ) and hwp.box_no in ( #{boxNo} ) and hwp.dept_id in ( #{deliveryId} ) and hwp.plan_status in ( #{status} ) and hwp.exception_type in ( #{item} ) and hwp.express_status in ( #{item} ) and t.id in ( #{item} ) and d.courier_id in ( #{item} ) and hwp.data_source in ( #{item} ) and hwp.create_dept_id in ( #{item} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.plan_arrival_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.plan_sorting_time between #{dto.startTimeLong} and #{dto.endTimeLong} and hwp.transfer_center_id in ( #{filterCenterId} ) and hwp.transfer_center_id in ( #{centerId} ) and exists( select 1 from work_areas_postcode rddp where rddp.area_id in( concat('E_', #{item}) ) and rddp.postcode=hwp.to_code and rddp.`type` = 'COURIER' ) and hwp.to_code in ( #{item} ) and hwp.address_type in ( #{item} ) group by hwp.waybill_no");
        sqlList.add("select hwp.waybill_no as waybillNo, hwp.to_expand_code as toCode, hwp.to_code as toSampleCode, t.id as areaId , hwp.data_source as type, hwp.transfer_center_id as transferCenterId, hwp.transfer_center_name as transferCenterName, hwp.box_no as boxNo, hwp.delivery as delivery, hwp.dept_id as deliveryId from hub_waybill_pool hwp left join work_areas_courier t on t.station_id = hwp.dept_id and t.name = hwp.courier_work_area left join work_areas_courier_detail d on d.courier_wa_id = t.id and d.personnel_type = 1 where hwp.express_status != 205 and hwp.to_code in ( #{toCode} ) and hwp.create_time between #{dto.startTime} and #{dto.endTime} and hwp.create_dept_id in ( #{item} ) and hwp.transfer_center_id in ( #{transferCenterId} ) and IFNULL (t.id,-1) in ( #{areaId} ) and hwp.dept_id in ( #{deliveryId} ) and IFNULL (hwp.box_no,'') in ( #{boxNo} ) group by hwp.waybill_no");
        sqlList.add("select id as id, data_id as dataId, stop_index as stopIndex, format_address as formatAddress, finance_format_address as financeFormatAddress, sindex as sindex, lot_number as lotNumber, waybill_sort as waybillSort, waybill_no as waybillNo from route_plan_waybill_stop hats where hats.data_id=#{dataId}");
        sqlList.add("select id as id, max_waybill_count as maxWaybillCount,min_waybill_count as minWaybillCount ,color as color from hub_assign_task_setup where create_by = #{createBy}");
        sqlList.add("select id as id, task_id as taskId, task_no as taskNo, operation_type as operationType, content as content, create_by_name as createByName, create_time as createTime from hub_assign_task_log where task_id=#{vo.taskId} and operation_type=#{vo.operationType} and task_no = #{vo.taskNo} and task_no in ( #{taskNo} ) and create_time >= #{vo.startTime} and create_time <= #{vo.endTime} order by create_time desc");
        sqlList.add("select id as id, task_id as taskId, task_no as taskNo, stop_index as stopIndex, sindex as sindex, lot_number as lotNumber, recipient_stop as recipient, waybill_sort as waybillSort, format_address as formatAddress, finance_format_address as financeFormatAddress, stop_model as stopModel, delivery_format_address as deliveryFormatAddress , waybill_no as waybillNo from hub_assign_task_stop hats where hats.task_id = #{query.taskId} and hats.full_stop in ( #{item} ) and hats.waybill_no in ( #{item} ) order by sindex, waybill_sort");
        sqlList.add("select id as id, task_status as taskStatus, create_time as createTime from hub_assign_task where id in ( #{id} )");
        sqlList.add("select id as id, waybill_no as waybillNo, box_no as boxNo, to_code as toCode, add_type as addType, exception_type as exceptionType, origin as origin, arrival_time as arrivalTime, plan_status as planStatus, plan_arrival_time as planArrivalTimeLong, plan_sorting_time as planSortingTimeLong, create_time as createTime, create_by as createBy, create_by_name as createByName, create_dept_id as createDeptId, create_dept_name as createDeptName, transfer_center_id as transferCenterId from hub_waybill_pool where waybill_no in ( #{waybillNo} ) and transfer_center_id in ( #{filterCenterId} )");
        sqlList.add("select id, address_type AS addressType, `state` AS state, city AS city, area AS area, address AS address, post_code AS postCode, longitude , latitude, usage_count AS usageCount, `status`, create_by AS createBy, create_by_name AS createByName, update_by AS updateBy, update_by_name AS updateByName, dept_id AS deptId, dept_name AS deptName, create_time AS createTime, update_time AS updateTime from route_plan_address rpa where rpa.dept_id = #{routePlanAddressDTO.deptId} and rpa.address_type = #{routePlanAddressDTO.addressType} and rpa.post_code = #{routePlanAddressDTO.postCode} and rpa.state = #{routePlanAddressDTO.state} and rpa.city = #{routePlanAddressDTO.city} and rpa.area = #{routePlanAddressDTO.area} and rpa.address = #{routePlanAddressDTO.address} order by CAST(rpa.usage_count AS SIGNED) desc");
        sqlList.add("select id, address_type AS addressType, state_id AS stateId, city_id AS cityId, area_id AS areaId, `state`, city, area, address, post_code AS postCode, longitude, latitude, usage_count AS usageCount, `status`, create_by AS createBy, create_by_name AS createByName, update_by AS updateBy, update_by_name AS updateByName, dept_id AS deptId, dept_name AS deptName, create_time AS createTime, update_time AS updateTime from route_plan_address rpa where rpa.dept_id in ( #{deptId} ) and rpa.dept_id in ( #{deptId} ) and rpa.address_type = #{queryAddressListRequest.addressType} and rpa.status = 0 order by CAST(rpa.usage_count AS SIGNED) desc");
        sqlList.add("select id, address_type AS addressType, state_id AS stateId, city_id AS cityId, area_id AS areaId, `state`, city, area, address, post_code AS postCode, longitude, latitude, usage_count AS usageCount, `status`, create_by AS createBy, create_by_name AS createByName, update_by AS updateBy, update_by_name AS updateByName, dept_id AS deptId, dept_name AS deptName, create_time AS createTime, update_time AS updateTime from route_plan_address rpa where rpa.dept_id in ( #{deptId} ) and rpa.dept_id in ( #{deptId} ) and rpa.address_type = #{queryRoutePlanAddressRequest.addressType} and rpa.status = #{queryRoutePlanAddressRequest.status} and rpa.post_code like CONCAT('%', #{queryRoutePlanAddressRequest.postCode}, '%') and rpa.state_id = #{queryRoutePlanAddressRequest.stateId} and rpa.city_id = #{queryRoutePlanAddressRequest.cityId} and rpa.area_id = #{queryRoutePlanAddressRequest.areaId} AND rpa.create_time >= CONCAT(#{queryRoutePlanAddressRequest.beginTime}, ' 00:00:00') AND rpa.create_time <= CONCAT(#{queryRoutePlanAddressRequest.endTime}, ' 23:59:59') order by rpa.create_time desc");
        sqlList.add("select id, address_type AS addressType, state_id AS stateId, city_id AS cityId, area_id AS areaId, `state`, city, area, address, post_code AS postCode, longitude, latitude, usage_count AS usageCount, `status`, create_by AS createBy, create_by_name AS createByName, update_by AS updateBy, update_by_name AS updateByName, dept_id AS deptId, dept_name AS deptName, create_time AS createTime, update_time AS updateTime from route_plan_address where id = #{id}");
        sqlList.add("select id, delete_type, box_no, waybill_no, create_by, create_by_name, create_time from hub_waybill_pool_record hwpr where 1=1 and delete_type = #{hubWaybillPoolRecordQueryDTO.deleteType} and hwpr.box_no in ( #{boxNo} ) and hwpr.waybill_no in ( #{waybillNo} ) order by hwpr.create_time desc");
        sqlList.add("select id, delete_type, box_no, waybill_no, create_by, create_by_name, create_time from hub_waybill_pool_record where id = #{id}");
        sqlList.add("select id, driver_id as driverId, driver_name as driverName, dept_id as deptId, address_type as addressType, address, provinces, cities, counties, country, post_code as postCode, longitude, latitude, create_time as createTime, update_time as updateTime from route_plan_courier_address where del_flag=#{delFlag} and driver_id = #{userId} order by create_time desc limit 1");
        sqlList.add("select id, driver_id, driver_name, dept_id, address_type, address, provinces, cities, counties, country, post_code, longitude, latitude, del_flag, create_time, update_time from route_plan_courier_address where id=#{id} and del_flag=0");
        sqlList.add("select id, log_id as logId, result_json as resultJson, planned_count as plannedCount, planned_success as plannedSuccess, planned_fail as plannedFail from route_plan_async_data where id=#{id}");
        sqlList.add("select id, log_id as logId, result_json as resultJson, planned_count as plannedCount, planned_success as plannedSuccess, planned_fail as plannedFail from route_plan_async_data where log_id = #{id}");
        sqlList.add("select id, log_id as logId, result_json as resultJson, planned_count as plannedCount, planned_success as plannedSuccess, planned_fail as plannedFail from route_plan_async_data where log_id=#{logId}");
        sqlList.add("select id, package_no, dept_id, create_time, create_by, is_expire, destin_id, destin_type, departed, create_by_name, dept_name, destin_name, site_status, exchange_bureau_code, destin_area_code, start_center_id, destin_center_id, destin_center_name, check_out_time, package_type, delivery_line_name from mis_package_dept_ref where package_no in ( #{packageNo} )");
        sqlList.add("select id, request_type as requestType, status as status, status_id as statusId, status_href as statusHref, resource_id as resourceId, resource_href as resourceHref, dept_id as deptId, create_by as createBy, create_by_name as createByName, create_time as createTime, operator_role as operatorRole, request_method as requestMethod, request_param as requestParam, plan_code as planCode, area_id as areaId, model as model, supplier_mode as supplierMode, request_json as requestJson from route_plan_async_log where plan_code = #{planCode}");
        sqlList.add("select id, request_type as requestType, status as status, status_id as statusId, status_href as statusHref, resource_id as resourceId, resource_href as resourceHref, dept_id as deptId, create_by as createBy, create_by_name as createByName, create_time as createTime, operator_role as operatorRole, request_method as requestMethod, request_param as requestParam, plan_code as planCode, area_id as areaId, model as model, supplier_mode as supplierMode, request_json as requestJson, transfer_center_id as transferCenterId , transfer_center_name as transferCenter from route_plan_async_log where id=#{id}");
        sqlList.add("select id, request_type as requestType, status as status, status_id as statusId, status_href as statusHref, resource_id as resourceId, resource_href as resourceHref, dept_id as deptId, create_by as createBy, create_by_name as createByName, create_time as createTime, operator_role as operatorRole, request_method as requestMethod, request_param as requestParam, plan_code as planCode, model as model, supplier_mode as supplierMode, area_id as areaId from route_plan_async_log where status='pending' order by id");
        sqlList.add("select id, status, status_id as statusId, status_href as statusHref, resource_id as resourceId, resource_href as resourceHref, dept_id as deptId, create_by as createBy, create_by_name as createByName, create_time as createTime from route_plan_async_log where create_by=#{userId} and status=#{status} and create_time between #{startTime} and #{endTime} and del_flag=0 order by id desc limit 1");
        sqlList.add("select id, status, status_id as statusId, status_href as statusHref, resource_id as resourceId, resource_href as resourceHref, dept_id as deptId, create_by as createBy, create_by_name as createByName, create_time as createTime, plan_code as planCode from route_plan_async_log where dept_id=#{deptId} and status=#{status} and del_flag=0 order by id desc limit 1");
        sqlList.add("select id, task_no as taskNo, p_task_no as pTaskNo, o_task_no as oTaskNo, task_status as taskStatus, to_code as toCode, plan_status as planStatus, area_id as areaId, area_name as areaName, sequence_no as sequenceNo, plan_sorting_time as planSortingTimeLong, create_time as createTime, create_by as createBy, create_by_name as createByName, create_dept_id as createDeptId, create_dept_name as createDeptName, recipient_id as recipientId, recipient_name as recipientName, recipient_dept_id as recipientDeptId, recipient_dept_name as recipientDeptName, recipient_date as recipientDate, delivery_id as deliveryId, delivery as delivery, driver_id as driverId, driver_name as driverName, waybill_count as waybillCount, box_no as boxNo, transfer_center_id as transferCenterId, transfer_center as transferCenter, push_time as pushTime, push_user_id as pushUserId, push_user_name as pushUserName, plan_code as planCode, generate_style as generateStyle, delivery_line_name as deliveryLineName, delivery_day as deliveryDay, business_model as businessModel from hub_assign_task where id=#{id} and del_flag = 0");
        sqlList.add("select id, task_no as taskNo, p_task_no as pTaskNo, o_task_no as oTaskNo, task_status as taskStatus, to_code as toCode, plan_status as planStatus, area_id as areaId, area_name as areaName, sequence_no as sequenceNo, plan_sorting_time as planSortingTimeLong, create_time as createTime, create_by as createBy, create_by_name as createByName, create_dept_id as createDeptId, create_dept_name as createDeptName, recipient_id as recipientId, recipient_name as recipientName, recipient_dept_id as recipientDeptId, recipient_dept_name as recipientDeptName, recipient_date as recipientDate, delivery_id as deliveryId, delivery as delivery, driver_id as driverId, driver_name as driverName, waybill_count as waybillCount, box_no as boxNo, transfer_center_id as transferCenterId, transfer_center as transferCenter, push_time as pushTime, push_user_id as pushUserId, push_user_name as pushUserName, plan_code as planCode, generate_style as generateStyle, delivery_line_name as deliveryLineName, delivery_day as deliveryDay, business_model as businessModel from hub_assign_task where del_flag = 0 and area_id = #{areaId} and create_time between #{startTime} and #{endTime}");
        sqlList.add("select id, task_no as taskNo, p_task_no as pTaskNo, o_task_no as oTaskNo, task_status as taskStatus, to_code as toCode, plan_status as planStatus, area_id as areaId, area_name as areaName, sequence_no as sequenceNo, plan_sorting_time as planSortingTimeLong, create_time as createTime, create_by as createBy, create_by_name as createByName, create_dept_id as createDeptId, create_dept_name as createDeptName, recipient_id as recipientId, recipient_name as recipientName, recipient_dept_id as recipientDeptId, recipient_dept_name as recipientDeptName, recipient_date as recipientDate, delivery_id as deliveryId, delivery as delivery, driver_id as driverId, driver_name as driverName, waybill_count as waybillCount, box_no as boxNo, transfer_center_id as transferCenterId, transfer_center as transferCenter, push_time as pushTime, push_user_id as pushUserId, push_user_name as pushUserName, plan_code as planCode, generate_style as generateStyle, delivery_line_name as deliveryLineName, delivery_day as deliveryDay, business_model as businessModel from hub_assign_task where del_flag = 0 and id = ( select max(hatw.task_id) from hub_assign_task_waybill hatw where data_id = #{dataId} )");
        sqlList.add("select id, task_no as taskNo, p_task_no as pTaskNo, o_task_no as oTaskNo, task_status as taskStatus, to_code as toCode, plan_status as planStatus, area_id as areaId, area_name as areaName, sequence_no as sequenceNo, plan_sorting_time as planSortingTimeLong, create_time as createTime, create_by as createBy, create_by_name as createByName, create_dept_id as createDeptId, create_dept_name as createDeptName, recipient_id as recipientId, recipient_name as recipientName, recipient_dept_id as recipientDeptId, recipient_dept_name as recipientDeptName, recipient_date as recipientDate, delivery_id as deliveryId, delivery as delivery, driver_id as driverId, driver_name as driverName, waybill_count as waybillCount, box_no as boxNo, transfer_center_id as transferCenterId, transfer_center as transferCenter, push_time as pushTime, push_user_id as pushUserId, push_user_name as pushUserName, plan_code as planCode, generate_style as generateStyle, delivery_line_name as deliveryLineName, delivery_day as deliveryDay, business_model as businessModel from hub_assign_task where del_flag = 0 and id in ( #{id} )");
        sqlList.add("select id, to_email as toEmail, waybill_no as waybillNo, express_status as expressStatus, dept_id as deptId, delivery as delivery, package_no as packageNo, to_code as toCode, third_waybill_no as thirdWaybillNo, to_expand_code as toExpandCode, box_num as boxNum, target_center_id as targetCenterId, target_center_name as targetCenterName, courier_work_area as courierWorkArea from mis_waybill_info where del_flag=0 and package_no in ( #{packageNo} )");
        sqlList.add("select id, to_email as toEmail, waybill_no as waybillNo, express_status as expressStatus, dept_id as deptId, delivery as delivery, package_no as packageNo, to_code as toCode, third_waybill_no as thirdWaybillNo, to_expand_code as toExpandCode, driver_id as driverId, box_num as boxNum, target_center_id as targetCenterId, target_center_name as targetCenterName, courier_work_area as courierWorkArea from mis_waybill_info where del_flag=0 and waybill_no in ( #{waybillNo} )");
        sqlList.add("select id, waybill_no, box_no, type, data_source, create_by, create_by_name, create_time, create_dept_id, create_dept_name, update_by, update_by_name, update_time from hub_waybill_pool_into_out_log where waybill_no in ( #{item} ) and box_no in ( #{item} ) and create_time >= #{beginTime} and create_time <= #{endTime} and create_dept_id in ( #{item} ) order by create_time desc");
        sqlList.add("select lot.id, lot.status, lot.status_id as statusId, lot.status_href as statusHref, lot.resource_id as resourceId, lot.resource_href as resourceHref, lot.transfer_center_id as transferCenterId, lot.transfer_center_name as transferCenter, lot.dept_id as deptId, lot.create_by as createBy, lot.create_by_name as createByName, lot.create_time as createTime, lot.operator_role as operatorRole, lot.request_method as requestMethod, lot.plan_code as planCode, lgt.id as dataId, lgt.planned_count as plannedCount, lgt.planned_success as plannedSuccess, lgt.planned_fail as plannedFail, rdda.id as partitionId, rdda.name as areaCode, IFNULL(rdda.name,'-') as partitionName from route_plan_async_log lot left join route_plan_async_data lgt on lot.id = lgt.log_id left join work_areas_courier rdda on lot.area_id = rdda.id and rdda.status = 0 where lot.operator_role = 'manager' and lot.dept_id in ( #{deptId} ) and lot.plan_code=#{vo.planCode} and lot.status=#{vo.status} and lot.create_time between #{vo.createTimeBegin} and #{vo.createTimeEnd} and lgt.id in ( select data_id from route_plan_waybill rpw where rpw.waybill_no =#{vo.waybillNo} ) and lot.area_id in ( #{areaId} ) and lot.transfer_center_id in ( #{transferCenterId} ) and rdda.id in ( #{areaId} ) and lot.del_flag=0 order by lot.create_time desc");
        sqlList.add("select mw.id, mw.waybill_no as waybillNo, mw.to_country as toCountry, mw.to_state as toState, mw.to_city as toCity, mw.to_area as toArea, mw.to_street as toStreet, mw.to_num_int as toNumInt, mw.to_num_ext as toNumExt, mw.to_code as toCode, mw.longitude as longitude, mw.latitude as latitude FROM mis_waybill_info mw, hub_assign_task_waybill twy where mw.waybill_no = twy.waybill_no and twy.task_id = #{taskId}");
        sqlList.add("select mwi.id as id, mwi.dept_id as deptId, mwi.to_country as toCountry, mwi.to_state as toState, mwi.to_city as toCity, mwi.to_area as toArea, mwi.waybill_no as waybillNo, mwi.to_expand_code as toCode, mwi.express_status as expressStatus, mwi.service_type as serviceType, mwi.delivery as delivery, mwi.driver_id as driverId, mwi.longitude as longitude, mwi.latitude as latitude, mwi.to_street as toStreet, di.delete_flag as deleteFlag, di.waybill_sort as waybillSort from route_plan_complete_delete_info di inner join mis_waybill_info mwi on di.waybill_no = mwi.waybill_no where mwi.del_flag =0 and di.data_id =#{dataId}");
        sqlList.add("select mwi.id as id, mwi.waybill_no as waybillNo, mwi.waybill_sort as waybillSort, mwi.driver_id as driverId, mwi.data_type as dataType, mwi.distance as distance, mwi.cost_time as costTime, mwi.longitude as longitude, mwi.latitude as latitude, mwi.reasons_code as reasonsCode, mwi.data_id as dataId from route_plan_waybill mwi where data_id = #{dataId} order by mwi.data_type desc, mwi.driver_id, mwi.waybill_sort");
        sqlList.add("select mwi.id as orderId, mwi.third_waybill_no as thirdWaybillNo, mwi.package_no as packageNo, mwi.waybill_no as waybillNo, mwi.to_code as toCode, mwi.express_status as expressStatus, mwi.dept_id as deliveryId from mis_package_dept_ref mpdr, mis_waybill_info mwi where mpdr.package_no = mwi.package_no and mwi.dept_id in ( #{groupId} ) and mwi.express_status in(100, 217) and not exists ( select 1 from hub_waybill_pool hwp where hwp.waybill_no = mwi.waybill_no and hwp.box_no=mwi.package_no ) and not exists ( select 1 from hub_assign_task_waybill tay where tay.box_no = mpdr.package_no ) and mwi.dept_id not in ( #{deptId} )");
        sqlList.add("select mwi.id as orderId, mwi.third_waybill_no as thirdWaybillNo, mwi.package_no as packageNo, mwi.waybill_no as waybillNo, mwi.to_code as toCode, mwi.express_status as expressStatus, mwi.dept_id as deliveryId from mis_waybill_info mwi where mwi.express_status in(100, 217,202) and not exists ( select 1 from hub_waybill_pool hwp where hwp.waybill_no = mwi.waybill_no and hwp.box_no=mwi.package_no ) and not exists ( select 1 from hub_assign_task_waybill tay where tay.box_no = mwi.package_no ) and mwi.package_no in ( #{packageNo} )");
        sqlList.add("select mwi.waybill_no as waybillNo, mwi.longitude as longitude, mwi.latitude as latitude from hub_assign_task hat, hub_assign_task_waybill hatw, mis_waybill_info mwi where hat.id = hatw.task_id and hatw.waybill_no = mwi.waybill_no and hat.id in ( #{taskId} )");
        sqlList.add("select mwi.waybill_no as waybillNo, mwi.waybill_sort as waybillSort, mwi.driver_id as driverId, mwi.data_type as dataType, mwi.distance as distance, mwi.cost_time as costTime, mwi.longitude as longitude, mwi.latitude as latitude from route_plan_waybill mwi where mwi.data_id = #{dataId} and mwi.waybill_no = 'PD' limit 1");
        sqlList.add("select plt.waybill_no as waybillNo, plt.waybill_sort as waybillSort, plt.data_type as dataType, plt.distance as distance, plt.cost_time as costTime, plt.longitude as longitude, plt.latitude as latitude, plt.reasons_code as reasonsCode, mwi.id as id, mwi.driver_id as driverId, mwi.to_country as toCountry, mwi.to_state as toState, mwi.to_city as toCity, mwi.to_area as toArea, mwi.express_status as expressStatus, mwi.to_code as toCode, mwi.to_expand_code as toExpandCode, mwi.to_street as toStreet, st.stop_index as stopIndex from route_plan_waybill plt left join hub_assign_task_waybill hatw on plt.waybill_no = hatw.waybill_no and plt.data_id = hatw.data_id left join hub_assign_task_stop st on st.waybill_no = hatw.waybill_no and st.task_id = hatw.task_id left join mis_waybill_info mwi on plt.waybill_no = mwi.waybill_no where 1 = 1 and hatw.task_id = #{vo.taskId} and plt.waybill_no in ( #{item} ) order by plt.data_type desc, plt.waybill_sort");
        sqlList.add("select plt.waybill_no as waybillNo, plt.waybill_sort as waybillSort, plt.data_type as dataType, plt.distance as distance, plt.cost_time as costTime, plt.longitude as longitude, plt.latitude as latitude, plt.reasons_code as reasonsCode, plt.edit_address_stauts as editAddressStauts, mwi.id as id, mwi.driver_id as driverId, mwi.dept_id as deptId, mwi.to_country as toCountry, mwi.to_state as toState, mwi.to_city as toCity, mwi.to_area as toArea, mwi.express_status as expressStatus, mwi.to_code as toCode, mwi.to_expand_code as toExpandCode, mwi.to_street as toStreet from route_plan_waybill plt left join mis_waybill_info mwi on plt.waybill_no = mwi.waybill_no where plt.data_id = #{vo.dataId} and plt.waybill_no in ( #{item} ) order by plt.data_type desc, plt.waybill_sort");
        sqlList.add("select plt.waybill_no as waybillNo, plt.waybill_sort as waybillSort, plt.data_type as dataType, plt.longitude as longitude, plt.latitude as latitude, plt.reasons_code as reasonsCode, st.stop_index as stopIndex from route_plan_waybill plt left join hub_assign_task_waybill hatw on plt.waybill_no = hatw.waybill_no and plt.data_id = hatw.data_id left join hub_assign_task_stop st on st.waybill_no = hatw.waybill_no and st.task_id = hatw.task_id where 1 = 1 and hatw.task_id = #{vo.taskId} and plt.waybill_no in ( #{item} ) order by plt.data_type desc, plt.waybill_sort");
        sqlList.add("select plt.waybill_no as waybillNo, plt.waybill_sort as waybillSort, plt.data_type as dataType, plt.reasons_code as reasonsCode, plt.edit_address_stauts as editAddressStauts, plt.latitude as latitude, plt.longitude as longitude, lot.dept_id as deptId from route_plan_waybill plt left join route_plan_async_data lgt on lgt.id = plt.data_id left join route_plan_async_log lot on lot.id = lgt.log_id where plt.data_id = #{vo.dataId} and plt.waybill_no in ( #{item} ) order by plt.data_type desc, plt.waybill_sort");
        sqlList.add("select pool.id, pool.waybill_no as waybillNo, pool.box_no as boxNo, pool.to_code as toCode, pool.add_type as addType, pool.exception_type as exceptionType, pool.plan_arrival_time as planArrivalTimeLong, pool.plan_sorting_time as planSortingTimeLong, pool.transfer_center_id as transferCenterId from hub_waybill_pool pool where pool.box_no in ( #{boxNo} ) and transfer_center_id in ( #{filterCenterId} )");
        sqlList.add("select rec.plan_arrival_time as planArrivalTime, rec.plan_sort_time as planSortTime, way.waybill_no AS waybillNo from arrival_scan_waybill way left join arrival_scan_record rec on way.arrival_id = rec.id where way.waybill_no in ( #{waybillNo} )");
        sqlList.add("select rule.operation_code from task_pool_rule_allow_into rule left join task_pool_rule_group_ref ref on ref.rule_id = rule.rule_id");
        sqlList.add("select rule.operation_code from task_pool_rule_allow_out rule left join task_pool_rule_group_ref ref on ref.rule_id = rule.rule_id");
        sqlList.add("select sh.waybill_no from sys_scan_history sh where sh.del_flag = 0 and scan_type = 204 and sh.waybill_no in ( #{waybillNo} ) group by sh.waybill_no");
        sqlList.add("select stop_index as stopIndex, stop.waybill_no as waybillNo from hub_assign_task_stop stop where stop.task_id = #{taskId} and stop.waybill_no not in ( #{waybillNo} )");
        sqlList.add("select supplier from route_plan_supplier_other_info where other_id=#{info.otherId} and type=#{info.type}");
        sqlList.add("select t.id ,t.courier_wa_id as areaId ,t.courier_id as driverId , t.courier_name as driverName,t.personnel_type as personnelType from work_areas_courier_detail t where t.courier_wa_id=#{areaId}");
        sqlList.add("select t.id as id, t.name as areaCode , t.station_id as deliveryId, t.station_name as delivery, t.lower_limit as deliveryMin, t.upper_limit as deliveryMax, t.grid_number as sequenceNo, t.center_id as transitCenterId, t.center_name as transitCenterName, t.business_model as businessModel from work_areas_courier t where status=0 and t.name = #{vo.areaCode} and t.station_id =#{vo.deliveryId}");
        sqlList.add("select t.id as id, t.station_id as stationId, t.station_name as stationName from work_areas_courier t where t.id in ( #{id} ) and t.status = 0");
        sqlList.add("select t.id as id, t.waybill_no as waybillNo, t.data_id as dataId, t.box_no as boxNo, t.bag_flag as bagFlag, t.to_code as toCode, t.plan_arrival_time as planArrivalTime, t.plan_sorting_time as planSortingTime from hub_assign_task_waybill t where t.task_id in ( #{item} )");
        sqlList.add("select t.id as taskId, t.task_no as taskNo, t.create_time as createTime, (select count(*) from route_plan_task_waybill w where w.route_plan_task_id = t.id and w.del_flag = 0) as waybillCount from route_plan_task t where t.driver_id = #{dto.driverId} and t.delivery_id = #{dto.deliveryId} and t.del_flag = 0 and t.task_status = 1 and t.create_time between #{dto.startTime} and #{dto.endTime} and (select sum(w.addressee_scan) from route_plan_task_waybill w where w.route_plan_task_id = t.id and w.del_flag = 0) = 0 and (select sum(w.scan_flag) from route_plan_task_waybill w where w.route_plan_task_id = t.id and w.del_flag = 0) = 0 order by t.create_time DESC");
        sqlList.add("select t.id, t.name as areaCode , t.create_dept_id as createDeptId, t.station_id as deliveryId, t.station_name as delivery, t.center_id as transitCenterId, t.center_name as transitCenterName, t.status as enabledState, 2 as groupType, t.lower_limit as deliveryMin, t.upper_limit as deliveryMax, DATE_FORMAT(t.update_time, '%H:%i:%S %d/%m/%Y') as upDateTime, t.update_by_name as updateByName, t.grid_number as gridNumber, t.region_polygon_flag as regionPolygonFlag from work_areas_courier t where t.create_dept_id=#{vo.createDeptId} and t.name like concat('%',#{vo.areaCode}, '%') and t.station_id =#{vo.deliveryId} and t.center_id in( #{id} ) and t.center_id in( #{id} ) and t.status =#{vo.enabledState} and exists(select d.id from work_areas_courier_detail d where d.courier_wa_id = t.id) and not exists(select d.id from work_areas_courier_detail d where d.courier_wa_id = t.id) and exists( select p.id from work_areas_postcode p where p.area_id = concat(, t.id) and p.postcode in ( #{postcode} ) ) and t.region_polygon_flag =#{vo.regionPolygonFlag} order by t.id desc");
        sqlList.add("select t.id, t.name as areaCode , t.station_id as deliveryId, t.station_name as delivery, t.center_id as transitCenterId, t.center_name as transitCenterName, t.status as enabledState, t.lower_limit as deliveryMin, t.upper_limit as deliveryMax, 1 as dspPostcodeFlag , DATE_FORMAT(t.update_time,'%H:%i:%S %d/%m/%Y') AS upDateTime, t.update_by_name as updateByName from work_areas_courier t where t.name=#{areaCode} limit 1");
        sqlList.add("select t.id, t.name as areaCode , t.station_id as deliveryId, t.station_name as delivery, t.center_id as transitCenterId, t.center_name as transitCenterName, t.status as enabledState, t.lower_limit as deliveryMin, t.upper_limit as deliveryMax, 1 as dspPostcodeFlag , DATE_FORMAT(t.update_time,'%H:%i:%S %d/%m/%Y') AS upDateTime, t.update_by_name as updateByName, t.grid_number as gridNumber, t.business_model as businessModel from work_areas_courier t where t.id=#{id}");
        sqlList.add("select t1.id as dataId, t2.id as logId, t2.dept_id as deptId from route_plan_async_data t1, route_plan_async_log t2 where t1.log_id = t2.id and t1.id in ( #{item} )");
        sqlList.add("select t1.id as id, concat(station_id,'-',t2.postcode,'-',t2.freight_forwarder_id) as uniqueCode, t1.station_id as stationId, t2.postcode as postcode, t2.freight_forwarder_id as freightForwarderId, t1.business_model as businessModel from work_areas_courier t1 , work_areas_freight_forwarder t2 where t2.work_areas_courier_id = t1.id and t1.status =0");
        sqlList.add("select t1.id as id, concat(t1.station_id,'-',t2.postcode,'--1') as uniqueCode, t1.station_id as stationId, t2.postcode as postcode, t1.business_model as businessModel from work_areas_courier t1, work_areas_postcode t2 where t2.area_id = concat('E_', t1.id) and t1.status =0");
        sqlList.add("select task.id, task.task_no as taskNo, task.bag_count as bagCount, task.waybill_count as waybillCount, task.recipient_name as recipientName, task.recipient_date as recipientDate, (select count(*) from hub_assign_task_waybill hatw where hatw.task_id = task.id and received_flag = 1) as realityWaybillCount, transfer_center as transferCenter from hub_assign_task task where del_flag = 0 and recipient_dept_id = #{deliveryId} and recipient_date between #{dto.startDate} and #{dto.endDate} and task_status in (3, 7, 8) order by id desc");
        sqlList.add("select task.id, task.task_no as taskNo, task.task_status as taskStatus, task.area_id as areaId, task.area_name as areaName, (select count(1) from hub_assign_task_waybill hatw where hatw.task_id = task.id and bag_flag = 1) as waybillCount, case when task.task_status=3 then task.recipient_id else task.driver_id end driverId, case when task.task_status=3 then task.recipient_name else task.driver_name end driverName, task.transfer_center as transferCenter from hub_assign_task task where task.delivery_id=#{deliveryId} AND task.del_flag = 0 and task.push_time between #{dto.startDate} and #{dto.endDate} and task.task_status in(2,3,7,8) and task.driver_id = #{dto.courierId} order by task.task_status,id desc");
        sqlList.add("select task.id, task.task_no as taskNo, task.task_status as taskStatus, task.area_id as areaId, task.area_name as areaName, task.delivery_line_name as deliveryLineName, (select count(1) from hub_assign_task_waybill hatw where hatw.task_id = task.id and bag_flag = 1) as waybillCount, (select count(1) from hub_assign_task_waybill hatw where hatw.task_id = task.id and bag_flag = 1 and received_flag = 0) as unclaimedCount, case when task.task_status=3 then task.recipient_id else task.driver_id end driverId, case when task.task_status=3 then task.recipient_name else task.driver_name end driverName, task.transfer_center as transferCenter from hub_assign_task task where task.delivery_id=#{deliveryId} AND task.del_flag = 0 and task.delivery_day between #{dto.startDateLong} and #{dto.endDateLong} and task.task_status in(2,3,7,8) and task.driver_id = #{dto.courierId} order by task.push_time desc");
        sqlList.add("select task.id, task.task_no as taskNo, task.task_status as taskStatus, task.to_code as toCode, task.plan_status as planStatus, task.area_id as areaId, task.area_name as areaName, task.create_time as createTime, task.create_by as createBy, task.create_by_name as createByName, task.create_dept_id as createDeptId, task.create_dept_name as createDeptName, task.recipient_id as recipientId, task.recipient_name as recipientName, task.recipient_dept_id as recipientDeptId, task.recipient_dept_name as recipientDeptName, task.delivery_id as deliveryId, task.delivery as delivery, task.driver_id as driverId, task.driver_name as driverName, task.waybill_count as waybillCount, task.box_no as boxNo from hub_assign_task task where task.del_flag = 0 and task.id in (select distinct hatw.task_id from hub_assign_task_waybill hatw where hatw.box_no = #{boxNo}) order by id desc limit 1");
        sqlList.add("select task.id, task.task_no as taskNo, task.task_status as taskStatus, task.to_code as toCode, task.plan_status as planStatus, task.area_id as areaId, task.area_name as areaName, task.create_time as createTime, task.create_by as createBy, task.create_by_name as createByName, task.create_dept_id as createDeptId, task.create_dept_name as createDeptName, task.recipient_id as recipientId, task.recipient_name as recipientName, task.recipient_dept_id as recipientDeptId, task.recipient_dept_name as recipientDeptName, task.delivery_id as deliveryId, task.delivery as delivery, task.driver_id as driverId, task.driver_name as driverName, task.waybill_count as waybillCount, tw.box_no as boxNo from hub_assign_task task left join ( select distinct hatw.task_id, hatw.box_no from hub_assign_task_waybill hatw where hatw.box_no in ( #{packageNo} ) ) tw on task.id = tw.task_id where task.id in ( select distinct hatw.task_id from hub_assign_task_waybill hatw where hatw.box_no in ( #{packageNo} ) ) order by id desc");
        sqlList.add("select task_id as taskId, count(*) as taskWaybillCount from hub_assign_task_waybill where task_id in ( #{taskId} ) and received_flag = #{receivedFlag} group by task_id");
        sqlList.add("select task_id as taskId, count(distinct stop_index) as taskWaybillCount from hub_assign_task_stop where task_id in ( #{taskId} ) group by task_id");
        sqlList.add("select task_id as taskId, waybill_no as waybillNo from hub_assign_task_waybill where task_id in ( #{taskId} )");
        sqlList.add("select tn.* from ( select id, box_no as boxNo, line_name as lineName, allocation_status as allocationStatus, create_time as createTime, create_by as createBy, create_by_name as createByName, transfer_center_id as transferCenterId, transfer_center as transferCenter, (select 1 from hub_waybill_pool way inner join mis_waybill_info mwi on way.waybill_no = mwi.waybill_no and mwi.express_status != 205 where way.box_no=pool.box_no and way.exception_type=1 limit 1) as unmatchedArea, (select count(box_no) from hub_waybill_pool way inner join mis_waybill_info mwi on way.waybill_no = mwi.waybill_no and mwi.express_status != 205 where way.box_no=pool.box_no ) as boxNoCount from hub_box_pool pool where pool.box_no in ( #{item} ) and pool.create_time between #{dto.startTime} and #{dto.endTime} and pool.allocation_Status=#{dto.allocationStatus} and pool.line_name like concat('%',#{dto.lineName},'%') and pool.transfer_center_id in ( #{filterCenterId} ) and pool.transfer_center_id in ( #{centerId} ) ) tn where tn.boxNoCount != 0 order by tn.unmatchedArea is null ,tn.unmatchedArea,tn.allocationStatus,tn.createTime desc");
        sqlList.add("select to_code as postcode, COUNT(*) as waybillCount from hub_assign_task_waybill where task_id=#{taskId} group by to_code order by to_code");
        sqlList.add("select tpu.id, tpu.rule_name as ruleName, tpu.is_allow_or_not as isAllowOrNot, tpu.status as status, tpu.remark as remark, tpu.create_by as createBy, tpu.create_by_name as createByName, tpu.create_time as createTime, tpu.update_by as updateBy, tpu.update_by_name as updateByName, tpu.update_time as updateTime from task_pool_rule tpu where tpu.rule_name like concat('%', #{dto.ruleName} ,'%') and tpu.status = #{dto.status} and tpu.update_time >= concat(#{dto.startTime}, ' 00:00:00') and tpu.update_time <= concat(#{dto.endTime}, ' 23:59:59') and exists( select ref.id from task_pool_rule_group_ref ref where ref.rule_id = tpu.id and ref.group_id in( #{id} ) ) and exists( select ref.id from task_pool_rule_group_ref ref where ref.rule_id = tpu.id and ref.group_id in( #{id} ) ) order by create_time desc");
        sqlList.add("select twy.waybill_no as waybillNo, tats.sindex as stopIndex from hub_assign_task_waybill twy left join hub_assign_task_stop tats on twy.waybill_no = tats.waybill_no where twy.task_id = #{taskId} and tats.task_id = #{taskId}");
        sqlList.add("select type as type, area_id as areaId,delivery_id AS deliveryId,locations_json AS locationsJson from hub_task_map_region_polygon where type = 1 and delivery_id = #{query.deliveryId}");
        sqlList.add("select type as type, area_id as areaId,delivery_id AS deliveryId,locations_json AS locationsJson from hub_task_map_region_polygon where type = 2 and delivery_id = #{query.deliveryId} and area_id = #{query.areaId} and area_id = ''");
        sqlList.add("select w.grid_number as gridNumber, hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.to_code as toCode, hat.plan_status as planStatus, hat.area_id as areaId, hat.area_name as areaName, hat.sequence_no as sequenceNo, hat.plan_sorting_time as planSortingTimeLong, hat.create_time as createTime, hat.create_by as createBy, hat.create_by_name as createByName, hat.create_dept_id as createDeptId, hat.create_dept_name as createDeptName, hat.recipient_id as recipientId, hat.recipient_name as recipientName, hat.recipient_dept_id as recipientDeptId, hat.recipient_dept_name as recipientDeptName, hat.recipient_date as recipientDate, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.driver_id as driverId, hat.driver_name as driverName, hat.waybill_count as waybillCount, hat.box_no as boxNo, hat.update_by as updateBy, hat.update_by_name as updateByName, hat.update_time as updateByTime, hat.transfer_center_id as transferCenterId, hat.transfer_center as transferCenter, hat.push_time as pushTime, hat.push_user_id as pushUserId, hat.push_user_name as pushUserName from hub_assign_task hat left join work_areas_courier w on hat.area_id = w.id where hat.create_time between #{startDate} and #{endDate} and hat.del_flag = 0 and hat.transfer_center_id in ( #{filterCenterId} ) and hat.transfer_center_id in ( #{centerId} )");
        sqlList.add("select w.grid_number as gridNumber, hat.id, hat.task_no as taskNo, hat.task_status as taskStatus, hat.to_code as toCode, hat.plan_status as planStatus, hat.area_id as areaId, hat.area_name as areaName, hat.sequence_no as sequenceNo, hat.plan_sorting_time as planSortingTimeLong, hat.create_time as createTime, hat.create_by as createBy, hat.create_by_name as createByName, hat.create_dept_id as createDeptId, hat.create_dept_name as createDeptName, hat.recipient_id as recipientId, hat.recipient_name as recipientName, hat.recipient_dept_id as recipientDeptId, hat.recipient_dept_name as recipientDeptName, hat.recipient_date as recipientDate, hat.delivery_id as deliveryId, hat.delivery as delivery, hat.driver_id as driverId, hat.driver_name as driverName, hat.waybill_count as waybillCount, hat.box_no as boxNo, hat.update_by as updateBy, hat.update_by_name as updateByName, hat.update_time as updateByTime, hat.transfer_center_id as transferCenterId, hat.transfer_center as transferCenter, hat.push_time as pushTime, hat.push_user_id as pushUserId, hat.push_user_name as pushUserName from hub_assign_task hat left join work_areas_courier w on hat.area_id = w.id where hat.plan_sorting_time between #{date} and #{date} and hat.del_flag = 0 and hat.transfer_center_id in ( #{filterCenterId} ) and hat.transfer_center_id in ( #{centerId} )");
        sqlList.add("select w.waybill_no as waybillNo,ta.create_time as createTime,ta.task_status as taskStatus from hub_assign_task_waybill w left join hub_assign_task ta on w.task_id = ta.id where w.waybill_no in ( #{waybillNo} )");
        sqlList.add("select wayb.waybill_no as waybillNo, wayb.waybill_sort as waybillSort, wayb.longitude as longitude, wayb.latitude as latitude from route_plan_async_log log inner join route_plan_async_data data on data.log_id = log.id inner join route_plan_waybill wayb on wayb.data_id = data.id where log.plan_code = #{planCode}");
        sqlList.add("select wayb.waybill_sort as waybillSort, wayb.longitude as longitude, wayb.latitude as latitude from route_plan_async_log log inner join route_plan_async_data data on data.log_id = log.id inner join route_plan_waybill wayb on wayb.data_id = data.id where log.plan_code = #{planCode} and wayb.data_type = 1 order by wayb.waybill_sort");
        sqlList.add("select waybill_no as waybillNo, task_id as taskId from hub_assign_task_waybill where waybill_no in ( #{waybillNo} )");
        sqlList.add("update hub_assign_task hat set bag_count = ( select count(1) from hub_assign_task_waybill hatw where hatw.task_id = hat.id and bag_flag = 1 ) where hat.id in ( select task_id from hub_assign_task_waybill where 1 = 1 and waybill_no in ( #{waybillNo} ) ) and hat.task_status not in (2, 3, 7, 8, 4)");
        sqlList.add("update hub_assign_task set box_no=#{vo.boxNo}, o_task_no=#{vo.oTaskNo}, waybill_count=#{vo.waybillCount}, bag_count=#{vo.bagCount}, to_code=#{vo.toCode}, update_by =#{vo.updateBy}, update_by_name =#{vo.updateByName}, task_split_mode = #{vo.taskSplitMode}, generate_style = #{vo.generateStyle}, generate_rule = #{vo.generateRule}, plan_code = #{vo.planCode}, plan_status = #{vo.planStatus}, task_status=#{vo.taskStatus}, update_time =#{vo.updateByTime} where id=#{vo.id}");
        sqlList.add("update hub_assign_task set box_no=#{vo.boxNo}, o_task_no=#{vo.oTaskNo}, waybill_count=#{vo.waybillCount}, bag_count=#{vo.bagCount}, to_code=#{vo.toCode}, update_by =#{vo.updateBy}, update_by_name =#{vo.updateByName}, task_status=#{vo.taskStatus}, update_time =#{vo.updateByTime} where id=#{vo.id}");
        sqlList.add("update hub_assign_task set del_flag = 1 where id = #{id}");
        sqlList.add("update hub_assign_task set del_flag = 1 where id in ( #{id} )");
        sqlList.add("update hub_assign_task set delivery_id=#{vo.deliveryId}, delivery=#{vo.delivery}, driver_id=#{vo.driverId}, driver_name=#{vo.driverName}, update_by =#{vo.updateBy}, update_by_name =#{vo.updateByName}, update_time =#{vo.updateByTime} where id=#{vo.id}");
        sqlList.add("update hub_assign_task set delivery_id=#{vo.deliveryId}, delivery=#{vo.delivery}, update_by =#{vo.updateBy}, update_by_name =#{vo.updateByName}, update_time =#{vo.updateByTime} where id in ( #{id} )");
        sqlList.add("update hub_assign_task set delivery_line_name = #{deliveryLineName}, sort_code = null where id = #{taskId}");
        sqlList.add("update hub_assign_task set driver_id=#{vo.driverId}, driver_name=#{vo.driverName}, update_by =#{vo.updateBy}, update_by_name =#{vo.updateByName}, update_time =#{vo.updateByTime} where id=#{vo.id}");
        sqlList.add("update hub_assign_task set plan_status = #{planStatus} where id in ( #{taskId} )");
        sqlList.add("update hub_assign_task set plan_status=#{planStatus} , plan_code=#{planCode} where id=#{id}");
        sqlList.add("update hub_assign_task set plan_status=#{planStatus} where id =( select max(hatw.task_id) from hub_assign_task_waybill hatw where data_id = #{dataId} )");
        sqlList.add("update hub_assign_task set plan_status=#{planStatus} where id=#{id}");
        sqlList.add("update hub_assign_task set sequence_no = #{sequenceNo} where id = #{id}");
        sqlList.add("update hub_assign_task set task_status = #{vo.taskStatus}, update_by = #{vo.updateBy}, update_by_name = #{vo.updateByName}, update_time = #{vo.updateByTime}, push_user_id = null, push_time = null, push_user_name = null, recipient_date = null, recipient_dept_id = null, recipient_dept_name = null, recipient_id = null, recipient_name = null, delivery_day = null where id in( #{id} )");
        sqlList.add("update hub_assign_task set task_status = 6, update_by = #{task.updateBy}, update_by_name = #{task.updateByName}, update_time = #{task.updateByTime} where id in ( #{id} )");
        sqlList.add("update hub_assign_task set task_status=#{vo.taskStatus}, update_time =#{vo.updateByTime} where id=#{vo.id}");
        sqlList.add("update hub_assign_task set task_status=2, delivery_mode =#{vo.deliveryMode}, delivery_day =#{vo.deliveryDay}, update_by =#{vo.updateBy}, update_by_name =#{vo.updateByName}, update_time =#{vo.updateByTime}, push_user_id=#{vo.updateBy}, push_user_name=#{vo.updateByName}, push_time=#{vo.updateByTime} where id in( #{id} )");
        sqlList.add("update hub_assign_task_stop set sindex = #{stopIndex}, stop_index = concat(, #{stopIndex}) where task_id = #{taskId} and id in ( #{stopUpdateId} )");
        sqlList.add("update hub_assign_task_stop set task_id = #{newTaskId}, task_no = #{newTaskNo} where task_id = #{taskId} and waybill_no in ( #{waybillNo} )");
        sqlList.add("update hub_assign_task_waybill hatw set bag_flag =1 where 1 = 1 and exists (select id from hub_assign_task hat where hat.id = hatw.task_id and hat.task_status not in (2, 3, 7, 8, 4) ) and waybill_no in ( #{waybillNo} )");
        sqlList.add("update hub_assign_task_waybill set data_id=#{dataId} where task_Id=#{taskId}");
        sqlList.add("update hub_assign_task_waybill set task_id = #{newTaskId} where task_id = #{taskId} and waybill_no in ( #{waybillNo} )");
        sqlList.add("update hub_box_pool set allocation_status=#{vo.allocationStatus}, create_time=#{vo.createTime}, create_by=#{vo.createBy}, create_by_name=#{vo.createByName}, create_dept_id=#{vo.createDeptId}, create_dept_name=#{vo.createDeptName} where box_no in( #{boxNo} )");
        sqlList.add("update hub_box_pool set allocation_status=2, create_time=#{vo.createTime}, create_by=#{vo.createBy}, create_by_name=#{vo.createByName}, create_dept_id=#{vo.createDeptId}, create_dept_name=#{vo.createDeptName}");
        sqlList.add("update hub_waybill_pool set dept_id = #{hubWaybillPool.deptId}, delivery = #{hubWaybillPool.delivery}, to_expand_code = #{hubWaybillPool.toExpandCode}, express_status = #{hubWaybillPool.expressStatus}, courier_work_area = #{hubWaybillPool.courierWorkArea} where id = #{hubWaybillPool.id}");
        sqlList.add("update hub_waybill_pool set exception_type = #{vo.exceptionType}, update_time = #{vo.updateTime}, update_by = #{vo.updateBy}, update_by_name = #{vo.updateByName} where id in( #{id} )");
        sqlList.add("update hub_waybill_pool_record set delete_type = #{deleteType}, box_no = #{boxNo}, waybill_no = #{waybillNo}, create_by = #{createBy}, create_by_name = #{createByName}, create_time = #{createTime} where id = #{id}");
        sqlList.add("update hub_waybill_pool_record set delete_type = #{deleteType}, box_no = #{boxNo}, waybill_no = #{waybillNo}, create_by = #{createBy}, create_by_name = #{createByName}, create_time = #{createTime} where id = #{id}");
        sqlList.add("update route_plan_address set `status` = #{status}, update_by = #{updateBy}, update_by_name = #{updateByName}, update_time = #{updateTime} where id = #{id}");
        sqlList.add("update route_plan_address set address_type = #{addressType}, `state` = #{state}, city = #{city}, area = #{area}, address = #{address}, post_code = #{postCode}, longitude = #{longitude}, latitude = #{latitude}, usage_count = #{usageCount}, `status` = #{status}, create_by = #{createBy}, create_by_name = #{createByName}, update_by = #{updateBy}, update_by_name = #{updateByName}, dept_id = #{deptId}, dept_name = #{deptName}, create_time = #{createTime}, update_time = #{updateTime} where id = #{id}");
        sqlList.add("update route_plan_address set usage_count = #{usageCount}, `status` = #{status}, update_by = #{updateBy}, update_by_name = #{updateByName}, update_time = #{updateTime} where id = #{id}");
        sqlList.add("update route_plan_async_data set planned_count=#{vo.plannedCount}, planned_success=#{vo.plannedSuccess}, planned_fail=#{vo.plannedFail} ,result_json=#{vo.resultJson} where id=#{vo.id}");
        sqlList.add("update route_plan_async_log set del_flag=1 where id=#{id}");
        sqlList.add("update route_plan_async_log set request_param=#{vo.requestParam}, request_json=#{vo.requestJson} where id=#{vo.id}");
        sqlList.add("update route_plan_async_log set resource_id=#{vo.resourceId}, resource_href=#{vo.resourceHref}, request_param=#{vo.requestParam}, request_type=#{vo.requestType}, supplier_mode=#{vo.supplierMode}, request_method=#{vo.requestMethod}, distance=#{vo.distance}, duration=#{vo.duration}, update_time=#{vo.updateTime}, status=#{vo.status} where id=#{vo.id}");
        sqlList.add("update route_plan_async_log set resource_id=#{vo.resourceId}, resource_href=#{vo.resourceHref}, request_param=#{vo.requestParam}, request_type=#{vo.requestType}, supplier_mode=#{vo.supplierMode}, request_method=#{vo.requestMethod}, distance=#{vo.distance}, duration=#{vo.duration}, update_time=#{vo.updateTime}, status=#{vo.status} where id=#{vo.id} and status=#{flag}");
        sqlList.add("update route_plan_async_log set resource_id=#{vo.resourceId}, status=#{vo.status}, request_param=#{vo.requestParam}, supplier_mode=#{vo.supplierMode}, status_id = #{vo.statusId}, request_type=#{vo.requestType} where id=#{vo.id}");
        sqlList.add("update route_plan_async_log set status_id=#{vo.resourceId}, status_href=#{vo.resourceHref}, status=#{vo.status}, request_param=#{vo.requestParam}, request_type=#{vo.requestType} where id=#{vo.id}");
        sqlList.add("update route_plan_courier_address set address=#{ew.address}, latitude=#{ew.latitude}, longitude=#{ew.longitude}, post_code=#{ew.postCode}, provinces=#{ew.provinces}, country=#{ew.country}, counties=#{ew.counties}, cities=#{ew.cities}, driver_id=#{ew.driverId}, driver_name=#{ew.driverName}, dept_id=#{ew.deptId}, del_flag = #{ew.delFlag}, update_time=#{ew.updateTime} where id=#{ew.id}");
        sqlList.add("update route_plan_waybill set sign_flag=#{signFlag} where waybill_no in ( #{waybillNo} )");
        sqlList.add("update route_plan_waybill set waybill_sort=#{vo.waybillSort}, data_type=#{vo.dataType}, distance=#{vo.distance}, reasons_code=#{vo.reasonsCode}, cost_time=#{vo.costTime} where id=#{vo.id}");
        sqlList.add("update route_plan_waybill_stop set sindex = #{stopIndex}, stop_index = concat(, #{stopIndex}) where data_id = #{dataId} and id in ( #{stopUpdateId} )");
        sqlList.add("update route_plan_waybill_stop set waybill_sort = #{waybillSort} where id = #{id}");
        sqlList.add("update zt_common_message_consume_record set retry = retry + 1, message = #{q.message}, update_time = now() where topic = #{q.topic} and tag = #{q.tag} and body_md5 = #{q.bodyMd5} and status = -1");


        // 提取所有表名
        List<String> tableNames = extractTableNamesFromBatch(sqlList);
        
        // 输出结果
        System.out.println("提取到的所有表名：");
        for (int i = 0; i < tableNames.size(); i++) {
            System.out.println(tableNames.get(i));
        }
    }
}